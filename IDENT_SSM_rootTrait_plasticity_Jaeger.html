<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Florentin C. Jaeger">
<meta name="dcterms.date" content="2024-06-27">
<meta name="description" content="Data preparation and computation of absorptive fine root trait plasticity">

<title>Young temperate tree species show fine-root trait acclimation to differences in water availability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/clipboard/clipboard.min.js"></script>
<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/quarto.js"></script>
<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/popper.min.js"></script>
<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/anchor.min.js"></script>
<link href="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="IDENT_SSM_rootTrait_plasticity_Jaeger_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation">Preparation</a>
  <ul class="collapse">
  <li><a href="#load-the-libraries" id="toc-load-the-libraries" class="nav-link" data-scroll-target="#load-the-libraries">Load the libraries</a></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">Load the data</a></li>
  <li><a href="#clean-and-organise-the-above-ground-data" id="toc-clean-and-organise-the-above-ground-data" class="nav-link" data-scroll-target="#clean-and-organise-the-above-ground-data">Clean and organise the above ground data</a></li>
  <li><a href="#compute-means-on-plot-level-48-plots" id="toc-compute-means-on-plot-level-48-plots" class="nav-link" data-scroll-target="#compute-means-on-plot-level-48-plots">Compute means on plot level (48 plots)</a></li>
  <li><a href="#join-above--and-below-ground" id="toc-join-above--and-below-ground" class="nav-link" data-scroll-target="#join-above--and-below-ground">Join above- and below ground</a></li>
  <li><a href="#function-to-display-linear-model" id="toc-function-to-display-linear-model" class="nav-link" data-scroll-target="#function-to-display-linear-model">Function to display linear model</a></li>
  </ul></li>
  <li><a href="#compute-individual-species-level-plasticity" id="toc-compute-individual-species-level-plasticity" class="nav-link" data-scroll-target="#compute-individual-species-level-plasticity">Compute individual (species level) plasticity</a>
  <ul class="collapse">
  <li><a href="#coefficient-of-variation" id="toc-coefficient-of-variation" class="nav-link" data-scroll-target="#coefficient-of-variation">Coefficient of variation</a></li>
  <li><a href="#piv-cvm-and-pi-cv" id="toc-piv-cvm-and-pi-cv" class="nav-link" data-scroll-target="#piv-cvm-and-pi-cv">PIv, CVm, and PI : CV</a></li>
  </ul></li>
  <li><a href="#plasticity-bootstrap-traits-0-30-cm-soil-depth" id="toc-plasticity-bootstrap-traits-0-30-cm-soil-depth" class="nav-link" data-scroll-target="#plasticity-bootstrap-traits-0-30-cm-soil-depth">Plasticity bootstrap traits 0-30 cm soil depth</a>
  <ul class="collapse">
  <li><a href="#preparation-for-bootstrap" id="toc-preparation-for-bootstrap" class="nav-link" data-scroll-target="#preparation-for-bootstrap">Preparation for bootstrap</a></li>
  <li><a href="#bootstrap-piv-rbd-over-wbio" id="toc-bootstrap-piv-rbd-over-wbio" class="nav-link" data-scroll-target="#bootstrap-piv-rbd-over-wbio">Bootstrap PIv RBD over WBIO</a></li>
  <li><a href="#bootstrap-cvt-rbd-over-wbio" id="toc-bootstrap-cvt-rbd-over-wbio" class="nav-link" data-scroll-target="#bootstrap-cvt-rbd-over-wbio">Bootstrap CVt RBD over WBIO</a></li>
  <li><a href="#bootstrap-pi-cv-rbd-over-wbio" id="toc-bootstrap-pi-cv-rbd-over-wbio" class="nav-link" data-scroll-target="#bootstrap-pi-cv-rbd-over-wbio">Bootstrap PI : CV RBD over WBIO</a></li>
  <li><a href="#bootstrap-cvm-rbd-over-wbio" id="toc-bootstrap-cvm-rbd-over-wbio" class="nav-link" data-scroll-target="#bootstrap-cvm-rbd-over-wbio">Bootstrap CVm RBD over WBIO</a></li>
  <li><a href="#arrange-multiplot-rbd" id="toc-arrange-multiplot-rbd" class="nav-link" data-scroll-target="#arrange-multiplot-rbd">Arrange multiplot RBD</a></li>
  <li><a href="#bootstrap-piv-rld-over-wbio" id="toc-bootstrap-piv-rld-over-wbio" class="nav-link" data-scroll-target="#bootstrap-piv-rld-over-wbio">Bootstrap PIv RLD over WBIO</a></li>
  <li><a href="#bootstrap-cvt-rld-over-wbio" id="toc-bootstrap-cvt-rld-over-wbio" class="nav-link" data-scroll-target="#bootstrap-cvt-rld-over-wbio">Bootstrap CVt RLD over WBIO</a></li>
  <li><a href="#bootstrap-pi-cv-rld-over-wbio" id="toc-bootstrap-pi-cv-rld-over-wbio" class="nav-link" data-scroll-target="#bootstrap-pi-cv-rld-over-wbio">Bootstrap PI : CV RLD over WBIO</a></li>
  <li><a href="#bootstrap-cvm-rld-over-wbio" id="toc-bootstrap-cvm-rld-over-wbio" class="nav-link" data-scroll-target="#bootstrap-cvm-rld-over-wbio">Bootstrap CVm RLD over WBIO</a></li>
  <li><a href="#arrange-multiplot-rld" id="toc-arrange-multiplot-rld" class="nav-link" data-scroll-target="#arrange-multiplot-rld">Arrange multiplot RLD</a></li>
  </ul></li>
  <li><a href="#invitation-for-collaboration" id="toc-invitation-for-collaboration" class="nav-link" data-scroll-target="#invitation-for-collaboration">Invitation for collaboration</a>
  <ul class="collapse">
  <li><a href="#reproduction-guidelines-and-further-research" id="toc-reproduction-guidelines-and-further-research" class="nav-link" data-scroll-target="#reproduction-guidelines-and-further-research">Reproduction guidelines and further research</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Young temperate tree species show fine-root trait acclimation to differences in water availability</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    Data preparation and computation of absorptive fine root trait plasticity
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Florentin C. Jaeger <a href="mailto:jaeger.florentin_clemens@courrier.uqam.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Université du Québec à Montréal
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 27, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="preparation" class="level1">
<h1>Preparation</h1>
<section id="load-the-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-the-libraries">Load the libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'

The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from 'package:dplyr':

    between, first, last

The following object is masked from 'package:purrr':

    transpose</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cowplot'

The following object is masked from 'package:lubridate':

    stamp</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sjPlot'

The following objects are masked from 'package:cowplot':

    plot_grid, save_plot</code></pre>
</div>
</div>
</section>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the data</h2>
<p>Absorptive fine root trait table from previous R script</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>absorptive <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"absorptive.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">strip.white =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"NA"</span>,<span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Above ground data to regress absorptive fine root trait plasticity over woody biomass (WBIO)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"above_ground_fall2018.core.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip.white =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"NA"</span>,<span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-and-organise-the-above-ground-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-and-organise-the-above-ground-data">Clean and organise the above ground data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(above_ground)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1200 obs. of  19 variables:
 $ id_FallAssessment   : chr  "11ACSA" "11ACSA" "11ACSA" "11ACSA" ...
 $ id_block_plot_sp_h2o: chr  "11ACSAH" "11ACSAH" "11ACSAH" "11ACSAH" ...
 $ block               : int  1 1 1 1 1 1 1 1 1 1 ...
 $ plot                : int  1 1 1 1 1 1 1 1 1 1 ...
 $ tree                : chr  "B2" "B3" "B4" "B5" ...
 $ location            : chr  "C" "C" "C" "C" ...
 $ sp                  : chr  "ACSA" "ACSA" "ACSA" "ACSA" ...
 $ h2o                 : chr  "H" "H" "H" "H" ...
 $ bd_mm               : num  19.3 16.7 24.1 20.4 22.1 ...
 $ ba_mm2              : num  292 219 457 328 383 ...
 $ ba_cm2              : num  2.92 2.19 4.57 3.28 3.83 2.04 4.63 2.74 1.91 4.08 ...
 $ ba_m2               : num  0.000292 0.000219 0.000457 0.000328 0.000383 ...
 $ ba_m2_m2            : num  7.29e-05 5.46e-05 1.14e-04 8.21e-05 9.56e-05 ...
 $ ba_m2_ha            : num  0.729 0.546 1.143 0.821 0.956 ...
 $ ht_cm               : chr  "90" "114" "150" "118" ...
 $ status6_live_dead   : chr  "alive" "alive" "alive" "alive" ...
 $ lbio                : num  61.6 44.1 103.6 70.6 84.3 ...
 $ agbio               : num  145.1 95.8 276.9 172.1 214.3 ...
 $ wbio                : num  83.5 51.7 173.4 101.5 130 ...</code></pre>
</div>
</div>
<p>We can see that not all data columns have the proper format, so we need to adjust this for downstream analysis. In the next step we <code>subset</code> only the alive trees. We will replace the existing <code>data.frame "above_ground"</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> <span class="fu">subset</span>(above_ground, status6_live_dead <span class="sc">!=</span> <span class="st">"dead"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rename and factorize sp and H<sub>2</sub>O</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(above_ground)[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="st">"species"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(above_ground,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">species =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">"BEPA"</span> <span class="sc">~</span> <span class="st">"Betula papyrifera"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"QURU"</span> <span class="sc">~</span> <span class="st">"Quercus rubra"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"ACSA"</span> <span class="sc">~</span> <span class="st">"Acer saccharum"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"LALA"</span> <span class="sc">~</span> <span class="st">"Larix laricina"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"PIST"</span> <span class="sc">~</span> <span class="st">"Pinus strobus"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"PIGL"</span> <span class="sc">~</span> <span class="st">"Picea glauca"</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>above_ground<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(above_ground<span class="sc">$</span>species,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Betula papyrifera"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Quercus rubra"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Acer saccharum"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Larix laricina"</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Pinus strobus"</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Picea glauca"</span>))</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> above_ground <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">h2o =</span> <span class="fu">case_when</span>(h2o <span class="sc">==</span> <span class="st">"H"</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                         h2o <span class="sc">==</span> <span class="st">"L"</span> <span class="sc">~</span> <span class="st">"Low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">h2o =</span> <span class="fu">factor</span>(h2o, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Low"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tree height (cm) was of data type character, so we need to change it to numeric</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>above_ground<span class="sc">$</span>ht_cm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(above_ground<span class="sc">$</span>ht_cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to join the above ground with the below ground table, we need a unique key. This key could be the combination of block and plot. The <code>data.frame "absorptive"</code> already has this key, so we only need to generate it for <code>"above_ground"</code>, akin to the concatenate function in MS Excel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>above_ground<span class="sc">$</span>block_plot <span class="ot">&lt;-</span> <span class="fu">paste</span>(above_ground<span class="sc">$</span>block,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                                 above_ground<span class="sc">$</span>plot,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s best to use type “character” for <code>join</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>absorptive<span class="sc">$</span>block_plot <span class="ot">&lt;-</span> <span class="fu">as.character</span>(absorptive<span class="sc">$</span>block_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-means-on-plot-level-48-plots" class="level2">
<h2 class="anchored" data-anchor-id="compute-means-on-plot-level-48-plots">Compute means on plot level (48 plots)</h2>
<p>Absorptive fine roots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>absorptive_level_plot <span class="ot">&lt;-</span> absorptive <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(block, block_plot, species, h2o, Soil_depth, FRB_g_cm3, SRL_m_g,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                length_aff_cm, avgdiam_mm, rootvol_aff_class_cm3, RTD_g_cm3,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                ntips_length_n_cm, RDMC_dry_g_fresh_g, SRA_cm2_g, RLD_cm_cm3) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, h2o, block, block_plot) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">FRB_G_cm3 =</span> <span class="fu">mean</span> (FRB_g_cm3),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SRL_m_g =</span> <span class="fu">mean</span> (SRL_m_g),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">LENGTH_aff_cm =</span> <span class="fu">mean</span> (length_aff_cm),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Diam_mm =</span> <span class="fu">mean</span> (avgdiam_mm),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Vol_aff_class_cm3 =</span> <span class="fu">mean</span> (rootvol_aff_class_cm3),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RTD_G_cm3 =</span> <span class="fu">mean</span> (RTD_g_cm3),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RBD_n_cm =</span> <span class="fu">mean</span> (ntips_length_n_cm),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RDMC_g_g =</span> <span class="fu">mean</span> (RDMC_dry_g_fresh_g),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SRA_CM2_g =</span> <span class="fu">mean</span> (SRA_cm2_g),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RLD_CM_cm3 =</span> <span class="fu">mean</span> (RLD_cm_cm3)) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">interaction</span>(block, block_plot, species, <span class="at">species =</span> <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Factorize and make sure the order is correct</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>absorptive_level_plot<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(absorptive_level_plot<span class="sc">$</span>species,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Betula papyrifera"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Quercus rubra"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Acer saccharum"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Larix laricina"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Pinus strobus"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Picea glauca"</span>))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>absorptive_level_plot<span class="sc">$</span>h2o <span class="ot">&lt;-</span> <span class="fu">factor</span>(absorptive_level_plot<span class="sc">$</span>h2o,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"High"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Low"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Above ground</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>aboveground_level_plot <span class="ot">&lt;-</span> above_ground <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(block, block_plot, species, h2o, ht_cm, lbio, agbio, wbio) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, h2o, block, block_plot) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">HT_cm =</span> <span class="fu">mean</span> (ht_cm),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">LBIO =</span> <span class="fu">mean</span> (lbio),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">AGBIO =</span> <span class="fu">mean</span> (agbio),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">WBIO =</span> <span class="fu">mean</span> (wbio)) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">interaction</span>(block, block_plot, species, <span class="at">species =</span> <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="join-above--and-below-ground" class="level2">
<h2 class="anchored" data-anchor-id="join-above--and-below-ground">Join above- and below ground</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(absorptive_level_plot,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                   aboveground_level_plot,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">by =</span> <span class="fu">join_by</span>(block_plot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inspect the outcome</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(absorptive_above_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [48 × 23] (S3: tbl_df/tbl/data.frame)
 $ species.x        : Factor w/ 6 levels "Betula papyrifera",..: 3 3 3 3 3 3 3 3 1 1 ...
 $ h2o.x            : Factor w/ 2 levels "High","Low": 1 1 1 1 2 2 2 2 1 1 ...
 $ block.x          : int [1:48] 1 4 7 8 2 3 5 6 1 4 ...
 $ block_plot       : chr [1:48] "11" "424" "711" "823" ...
 $ FRB_G_cm3        : num [1:48] 0.00432 0.00622 0.00302 0.00296 0.00402 0.00166 0.00248 0.00374 0.00348 0.00242 ...
 $ SRL_m_g          : num [1:48] 56.9 49.5 53.2 64.8 49.4 ...
 $ LENGTH_aff_cm    : num [1:48] 1987 2243 1505 1726 1739 ...
 $ Diam_mm          : num [1:48] 0.343 0.339 0.349 0.307 0.366 ...
 $ Vol_aff_class_cm3: num [1:48] 1.56 5.06 5.8 5.38 1.74 ...
 $ RTD_G_cm3        : num [1:48] 0.2136 0.1348 0.0468 0.187 0.2078 ...
 $ RBD_n_cm         : num [1:48] 1.07 1.27 1.29 1.47 1 ...
 $ RDMC_g_g         : num [1:48] 0.206 0.21 0.206 0.192 0.24 0.188 0.216 0.278 0.244 0.3 ...
 $ SRA_CM2_g        : num [1:48] 288 243 298 366 244 ...
 $ RLD_CM_cm3       : num [1:48] 24.2 24.4 16.3 16.8 18.7 ...
 $ group.x          : Factor w/ 48 levels "1.11.Acer saccharum._",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ species.y        : Factor w/ 6 levels "Betula papyrifera",..: 3 3 3 3 3 3 3 3 1 1 ...
 $ h2o.y            : Factor w/ 2 levels "High","Low": 1 1 1 1 2 2 2 2 1 1 ...
 $ block.y          : int [1:48] 1 4 7 8 2 3 5 6 1 4 ...
 $ HT_cm            : num [1:48] 132 195 224 179 151 ...
 $ LBIO             : num [1:48] 81.7 122.1 138.8 87.6 104 ...
 $ AGBIO            : num [1:48] 211 356 407 228 288 ...
 $ WBIO             : num [1:48] 129 234 268 140 184 ...
 $ group.y          : Factor w/ 288 levels "1.115.Betula papyrifera._",..: 99 105 111 117 123 129 135 141 1 7 ...</code></pre>
</div>
</div>
<p>We can remove obsolete variables (columns)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>group.x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>species.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>h2o.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>block.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>group.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rename variables to remove appended “x”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"species"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"h2o"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"block"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-display-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="function-to-display-linear-model">Function to display linear model</h2>
<p>(LM; plasticity over WBIO) In the <code>ggplot()</code> figure below we will be using the function <code>lm_eqn</code> to annotate the plot with the regression formula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-21"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-21-1"><a href="#annotated-cell-21-1" aria-hidden="true" tabindex="-1"></a>lm_eqn <span class="ot">=</span> <span class="cf">function</span>(m) {</span>
<span id="annotated-cell-21-2"><a href="#annotated-cell-21-2" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">format</span>(<span class="fu">coef</span>(m)[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="annotated-cell-21-3"><a href="#annotated-cell-21-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">format</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(m)[[<span class="dv">2</span>]]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-21-4" class="code-annotation-target"><a href="#annotated-cell-21-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">r2 =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared));</span>
<span id="annotated-cell-21-5"><a href="#annotated-cell-21-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">coef</span>(m)[[<span class="dv">2</span>]] <span class="sc">&gt;=</span> <span class="dv">0</span>)  {</span>
<span id="annotated-cell-21-6"><a href="#annotated-cell-21-6" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="fu">italic</span>(y) <span class="sc">==</span> a <span class="sc">+</span> b <span class="sc">%.%</span> <span class="fu">italic</span>(x)<span class="sc">*</span><span class="st">","</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(r)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">"="</span><span class="sc">~</span>r2,l)</span>
<span id="annotated-cell-21-7"><a href="#annotated-cell-21-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="annotated-cell-21-8"><a href="#annotated-cell-21-8" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="fu">italic</span>(y) <span class="sc">==</span> a <span class="sc">-</span> b <span class="sc">%.%</span> <span class="fu">italic</span>(x)<span class="sc">*</span><span class="st">","</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(r)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">"="</span><span class="sc">~</span>r2,l)</span>
<span id="annotated-cell-21-9"><a href="#annotated-cell-21-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="annotated-cell-21-10"><a href="#annotated-cell-21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="fu">as.expression</span>(eq));</span>
<span id="annotated-cell-21-11"><a href="#annotated-cell-21-11" aria-hidden="true" tabindex="-1"></a>}</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-21" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="4" data-code-annotation="1"><span class="math inline">\(R^2\)</span> with two decimal places</span>
</dd>
</dl>
</div>
</div>
</section>
</section>
<section id="compute-individual-species-level-plasticity" class="level1">
<h1>Compute individual (species level) plasticity</h1>
<section id="coefficient-of-variation" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-of-variation">Coefficient of variation</h2>
<p><span class="math display">\[
\text{CV} = \frac{\text{STDEV}(x)}{\text{MEAN}(x)}
\]</span> The coefficient of variation (CV) is calculated on a different level than PI. That means across all 8 species values (across both H<sub>2</sub>O treatments, high vs.&nbsp;low).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>CVt_traits <span class="ot">&lt;-</span> absorptive_above_plot <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, h2o, RLD_CM_cm3, SRL_m_g, SRA_CM2_g,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                RTD_G_cm3, RBD_n_cm, WBIO) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">CVt_RLD =</span> ((<span class="fu">sd</span> (RLD_CM_cm3)) <span class="sc">/</span> (<span class="fu">mean</span> (RLD_CM_cm3))),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_SRL =</span> ((<span class="fu">sd</span> (SRL_m_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRL_m_g))),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_RTD =</span> ((<span class="fu">sd</span> (RTD_G_cm3)) <span class="sc">/</span> (<span class="fu">mean</span> (RTD_G_cm3))),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_RBD =</span> ((<span class="fu">sd</span> (RBD_n_cm)) <span class="sc">/</span> (<span class="fu">mean</span> (RBD_n_cm))),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_SRA =</span> ((<span class="fu">sd</span> (SRA_CM2_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRA_CM2_g))),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_WBIO =</span> ((<span class="fu">sd</span> (WBIO)) <span class="sc">/</span> (<span class="fu">mean</span> (WBIO))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="piv-cvm-and-pi-cv" class="level2">
<h2 class="anchored" data-anchor-id="piv-cvm-and-pi-cv">PIv, CVm, and PI : CV</h2>
<p>Calculate the means per species and H<sub>2</sub>O treatment to calculate PIv, CVm, and PI : CV downstream.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>abs_ab_means_sph2o <span class="ot">&lt;-</span> absorptive_above_plot <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, h2o, RLD_CM_cm3, SRL_m_g, SRA_CM2_g,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                RTD_G_cm3, RBD_n_cm, WBIO) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, h2o) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">RLD_CM_CM3 =</span> <span class="fu">mean</span> (RLD_CM_cm3),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SRL_M_g =</span> <span class="fu">mean</span> (SRL_m_g),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RTD_G_CM3 =</span> <span class="fu">mean</span> (RTD_G_cm3),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">RBD_n_cm =</span> <span class="fu">mean</span> (RBD_n_cm),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SRA_CM2_G =</span> <span class="fu">mean</span> (SRA_CM2_g),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">WBIO =</span> <span class="fu">mean</span> (WBIO)) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">interaction</span>(species, h2o, <span class="at">species =</span> <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate PIv and CVm based on means <span class="citation" data-cites="valladaresQuantitativeEstimationPhenotypic2006">(<a href="#ref-valladaresQuantitativeEstimationPhenotypic2006" role="doc-biblioref">Valladares, Sanchez-Gomez, and Zavala 2006</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> abs_ab_means_sph2o <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, h2o, RLD_CM_CM3, SRL_M_g, RTD_G_CM3, RBD_n_cm,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                SRA_CM2_G, WBIO) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">PIv_RLD =</span> ((<span class="fu">max</span>(RLD_CM_CM3) <span class="sc">-</span> <span class="fu">min</span>(RLD_CM_CM3)) <span class="sc">/</span> <span class="fu">max</span>(RLD_CM_CM3)),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_SRL =</span> ((<span class="fu">max</span>(SRL_M_g) <span class="sc">-</span> <span class="fu">min</span>(SRL_M_g)) <span class="sc">/</span> <span class="fu">max</span>(SRL_M_g)),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_RTD =</span> ((<span class="fu">max</span>(RTD_G_CM3) <span class="sc">-</span> <span class="fu">min</span>(RTD_G_CM3)) <span class="sc">/</span> <span class="fu">max</span>(RTD_G_CM3)),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_RBD =</span> ((<span class="fu">max</span>(RBD_n_cm) <span class="sc">-</span> <span class="fu">min</span>(RBD_n_cm)) <span class="sc">/</span> <span class="fu">max</span>(RBD_n_cm)),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_SRA =</span> ((<span class="fu">max</span>(SRA_CM2_G) <span class="sc">-</span> <span class="fu">min</span>(SRA_CM2_G)) <span class="sc">/</span> <span class="fu">max</span>(SRA_CM2_G)),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_WBIO =</span> ((<span class="fu">max</span>(WBIO) <span class="sc">-</span> <span class="fu">min</span>(WBIO)) <span class="sc">/</span> <span class="fu">max</span>(WBIO)),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RLD =</span> ((<span class="fu">sd</span> (RLD_CM_CM3)) <span class="sc">/</span> (<span class="fu">mean</span> (RLD_CM_CM3))),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_SRL =</span> ((<span class="fu">sd</span> (SRL_M_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRL_M_g))),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RTD =</span> ((<span class="fu">sd</span> (RTD_G_CM3)) <span class="sc">/</span> (<span class="fu">mean</span> (RTD_G_CM3))),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RBD =</span> ((<span class="fu">sd</span> (RBD_n_cm)) <span class="sc">/</span> (<span class="fu">mean</span> (RBD_n_cm))),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_SRA =</span> ((<span class="fu">sd</span> (SRA_CM2_G)) <span class="sc">/</span> (<span class="fu">mean</span> (SRA_CM2_G))),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_WBIO =</span> ((<span class="fu">sd</span> (WBIO)) <span class="sc">/</span> (<span class="fu">mean</span> (WBIO))),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">WBIO =</span> <span class="fu">mean</span> (WBIO))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join the CVt to the PIv and CVm</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Plast_abs_sp_traits,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                 CVt_traits,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">by =</span> <span class="fu">join_by</span>(species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate the ratio of the PI to the CV: <span class="math display">\[
\frac{\text{PI}}{\text{CV}}
\]</span> <span class="citation" data-cites="tobnerInterspecificCoordinationIntraspecific2013">(<a href="#ref-tobnerInterspecificCoordinationIntraspecific2013" role="doc-biblioref">Tobner, Paquette, and Messier 2013</a>)</span> The individual plasticity values (per species) are just for display in the downstream <code>ggplot2</code> figure, not for the bootstrap itself. The plasticity values are calculated inside the bootstrap again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> Plast_abs_sp_traits <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">PI_CV_RLD =</span> (PIv_RLD <span class="sc">/</span> CVt_RLD),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_SRL =</span> (PIv_SRL <span class="sc">/</span> CVt_SRL),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_RTD =</span> (PIv_RTD <span class="sc">/</span> CVt_RTD),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_RBD =</span> (PIv_RBD <span class="sc">/</span> CVt_RBD),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_SRA =</span> (PIv_SRA <span class="sc">/</span> CVt_SRA),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_WBIO =</span> (PIv_WBIO <span class="sc">/</span> CVt_WBIO))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add the short species labels to <code>"Plast_abs_sp_traits"</code> to display based on x and y coordinates in downstream <code>ggplot</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Plast_abs_sp_traits,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">species_label =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">"Betula papyrifera"</span> <span class="sc">~</span> <span class="st">"Bp"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Quercus rubra"</span> <span class="sc">~</span> <span class="st">"Qr"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Acer saccharum"</span> <span class="sc">~</span> <span class="st">"As"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Larix laricina"</span> <span class="sc">~</span> <span class="st">"Ll"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Pinus strobus"</span> <span class="sc">~</span> <span class="st">"Ps"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Picea glauca"</span> <span class="sc">~</span> <span class="st">"Pg"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plasticity-bootstrap-traits-0-30-cm-soil-depth" class="level1">
<h1>Plasticity bootstrap traits 0-30 cm soil depth</h1>
<section id="preparation-for-bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="preparation-for-bootstrap">Preparation for bootstrap</h2>
<p>splitting and pasting the <code>data.frame</code> in a list</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>split_sp_h2o <span class="ot">&lt;-</span> <span class="fu">split</span>(absorptive_above_plot,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste</span>(absorptive_above_plot<span class="sc">$</span>species,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                            absorptive_above_plot<span class="sc">$</span>h2o))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-piv-rbd-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-piv-rbd-over-wbio">Bootstrap PIv RBD over WBIO</h2>
<p>Define the number of iterations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s important to note that there may be minor, stochastic variations in the bootstrap results presented below compared to those in the research paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-30"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-30-1"><a href="#annotated-cell-30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="annotated-cell-30-2"><a href="#annotated-cell-30-2" aria-hidden="true" tabindex="-1"></a>Boot_PIv_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="annotated-cell-30-3"><a href="#annotated-cell-30-3" aria-hidden="true" tabindex="-1"></a>  PIvRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="annotated-cell-30-4"><a href="#annotated-cell-30-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-30-5"><a href="#annotated-cell-30-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-30-6" class="code-annotation-target"><a href="#annotated-cell-30-6" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvRBD_WBIO))</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-30-7" class="code-annotation-target"><a href="#annotated-cell-30-7" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> combin_split_PIvRBD_WBIO[,.(<span class="at">means_RBD =</span> <span class="fu">mean</span>(RBD_n_cm),</span>
<span id="annotated-cell-30-8"><a href="#annotated-cell-30-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="annotated-cell-30-9"><a href="#annotated-cell-30-9" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="annotated-cell-30-10"><a href="#annotated-cell-30-10" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO[, PIvRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RBD) <span class="sc">-</span> <span class="fu">min</span>(means_RBD)) <span class="sc">/</span> <span class="fu">max</span>(means_RBD),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-30-11" class="code-annotation-target"><a href="#annotated-cell-30-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="annotated-cell-30-12"><a href="#annotated-cell-30-12" aria-hidden="true" tabindex="-1"></a>  PIv_RBD_WBIO <span class="ot">=</span> means_RBD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="annotated-cell-30-13"><a href="#annotated-cell-30-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">PIvRBD =</span> <span class="fu">mean</span>(PIvRBD)), by <span class="ot">=</span> species]</span>
<span id="annotated-cell-30-14"><a href="#annotated-cell-30-14" aria-hidden="true" tabindex="-1"></a>  PIv_RBD_WBIO <span class="ot">&lt;-</span> PIv_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(PIv_RBD_WBIO),</span>
<span id="annotated-cell-30-15"><a href="#annotated-cell-30-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(PIv_RBD_WBIO),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="5" onclick="event.preventDefault();" href="">5</a><span id="annotated-cell-30-16" class="code-annotation-target"><a href="#annotated-cell-30-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-30-17"><a href="#annotated-cell-30-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIvRBD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> PIv_RBD_WBIO)</span>
<span id="annotated-cell-30-18"><a href="#annotated-cell-30-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> PIv_RBD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="annotated-cell-30-19"><a href="#annotated-cell-30-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> PIv_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="annotated-cell-30-20"><a href="#annotated-cell-30-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvRBDWBIO))</span>
<span id="annotated-cell-30-21"><a href="#annotated-cell-30-21" aria-hidden="true" tabindex="-1"></a>})</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="6" data-code-annotation="2">Bring the results together</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="7" data-code-annotation="3">Compute means for each species and H<sub>2</sub>O treatment (leading comma means subset by columns) <code>[]</code> –&gt; contains vector</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="11" data-code-annotation="4">Compute PIv for each species. <code>:=</code> indicates a new column or updates (from <code>data.table</code>). Keep the mean for each species.</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="16" data-code-annotation="5">Optionally bootstrap species before doing the regression</span>
</dd>
</dl>
</div>
</div>
<p>Store the results in a <code>data.table</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIv_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIv_RBD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Produce the figure</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-32"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-32-1"><a href="#annotated-cell-32-1" aria-hidden="true" tabindex="-1"></a>PIv_RBD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_PIv_RBD_WBIO,</span>
<span id="annotated-cell-32-2"><a href="#annotated-cell-32-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> mean_means_WBIO, <span class="at">y =</span> y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="annotated-cell-32-3"><a href="#annotated-cell-32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="annotated-cell-32-4"><a href="#annotated-cell-32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">350</span>, <span class="at">y =</span> <span class="fl">0.8</span>,</span>
<span id="annotated-cell-32-5"><a href="#annotated-cell-32-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_PIv_RBD_WBIO)),</span>
<span id="annotated-cell-32-6"><a href="#annotated-cell-32-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-32" data-target-annotation="6" onclick="event.preventDefault();" href="">6</a><span id="annotated-cell-32-7" class="code-annotation-target"><a href="#annotated-cell-32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="annotated-cell-32-8"><a href="#annotated-cell-32-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="annotated-cell-32-9"><a href="#annotated-cell-32-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="annotated-cell-32-10"><a href="#annotated-cell-32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="annotated-cell-32-11"><a href="#annotated-cell-32-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(PIv <span class="sc">~</span> RBD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>n <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-32-12"><a href="#annotated-cell-32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits, <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> PIv_RBD,</span>
<span id="annotated-cell-32-13"><a href="#annotated-cell-32-13" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">label =</span> species_label),</span>
<span id="annotated-cell-32-14"><a href="#annotated-cell-32-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="annotated-cell-32-15"><a href="#annotated-cell-32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="annotated-cell-32-16"><a href="#annotated-cell-32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="annotated-cell-32-17"><a href="#annotated-cell-32-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="annotated-cell-32-18"><a href="#annotated-cell-32-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="annotated-cell-32-19"><a href="#annotated-cell-32-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="annotated-cell-32-20"><a href="#annotated-cell-32-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">21</span>),</span>
<span id="annotated-cell-32-21"><a href="#annotated-cell-32-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="annotated-cell-32-22"><a href="#annotated-cell-32-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="annotated-cell-32-23"><a href="#annotated-cell-32-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-32" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-32" data-code-lines="7" data-code-annotation="6"><code>geom_smooth()</code> will give a warning. However, we can ignore this since we want the function to run over all species and not group by the color aesthetic <code>"species"</code>.</span>
</dd>
</dl>
</div>
</div>
<p>Linear model to extract results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_PIvRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_PIv_RBD_WBIO)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stats_lm_boot_PIvRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_PIvRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_PIvRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-cvt-rbd-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-cvt-rbd-over-wbio">Bootstrap CVt RBD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-36"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-36-1"><a href="#annotated-cell-36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="annotated-cell-36-2"><a href="#annotated-cell-36-2" aria-hidden="true" tabindex="-1"></a>Boot_CVt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="annotated-cell-36-3"><a href="#annotated-cell-36-3" aria-hidden="true" tabindex="-1"></a>  CVtRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="annotated-cell-36-4"><a href="#annotated-cell-36-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-36-5"><a href="#annotated-cell-36-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="annotated-cell-36-6"><a href="#annotated-cell-36-6" aria-hidden="true" tabindex="-1"></a>  combin_split_CVtRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVtRBD_WBIO))</span>
<span id="annotated-cell-36-7"><a href="#annotated-cell-36-7" aria-hidden="true" tabindex="-1"></a>  RBD_WBIO <span class="ot">=</span> combin_split_CVtRBD_WBIO[,.(<span class="at">RBD =</span> (RBD_n_cm),</span>
<span id="annotated-cell-36-8"><a href="#annotated-cell-36-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">WBIO =</span> (WBIO)),</span>
<span id="annotated-cell-36-9"><a href="#annotated-cell-36-9" aria-hidden="true" tabindex="-1"></a>                                      by <span class="ot">=</span> .(species)]</span>
<span id="annotated-cell-36-10"><a href="#annotated-cell-36-10" aria-hidden="true" tabindex="-1"></a>  RBD_WBIO[, CVtRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RBD) <span class="sc">/</span> <span class="fu">mean</span>(RBD)),</span>
<span id="annotated-cell-36-11"><a href="#annotated-cell-36-11" aria-hidden="true" tabindex="-1"></a>           by <span class="ot">=</span> species]</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-36" data-target-annotation="7" onclick="event.preventDefault();" href="">7</a><span id="annotated-cell-36-12" class="code-annotation-target"><a href="#annotated-cell-36-12" aria-hidden="true" tabindex="-1"></a>  CVt_RBD_WBIO <span class="ot">=</span> RBD_WBIO[,.(<span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO),</span>
<span id="annotated-cell-36-13"><a href="#annotated-cell-36-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">CVtRBD =</span> <span class="fu">mean</span>(CVtRBD)), by <span class="ot">=</span> species]</span>
<span id="annotated-cell-36-14"><a href="#annotated-cell-36-14" aria-hidden="true" tabindex="-1"></a>  CVt_RBD_WBIO <span class="ot">&lt;-</span> CVt_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVt_RBD_WBIO),</span>
<span id="annotated-cell-36-15"><a href="#annotated-cell-36-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVt_RBD_WBIO),</span>
<span id="annotated-cell-36-16"><a href="#annotated-cell-36-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-36-17"><a href="#annotated-cell-36-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVtRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVtRBD <span class="sc">~</span> means_WBIO, <span class="at">data =</span> CVt_RBD_WBIO)</span>
<span id="annotated-cell-36-18"><a href="#annotated-cell-36-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">means_WBIO =</span> CVt_RBD_WBIO<span class="sc">$</span>means_WBIO,</span>
<span id="annotated-cell-36-19"><a href="#annotated-cell-36-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVt_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="annotated-cell-36-20"><a href="#annotated-cell-36-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVtRBDWBIO))</span>
<span id="annotated-cell-36-21"><a href="#annotated-cell-36-21" aria-hidden="true" tabindex="-1"></a>})</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-36" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-36" data-code-lines="12" data-code-annotation="7">Keep the mean for each species</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVt_RBD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Produce the figure</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>CVt_RBD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_CVt_RBD_WBIO,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> means_WBIO, <span class="at">y =</span> y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">350</span>, <span class="at">y =</span> <span class="fl">0.7</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> means_WBIO, <span class="at">data =</span> coefs_Boot_CVt_RBD_WBIO)),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(CVt <span class="sc">~</span> RBD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>n <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> CVt_RBD, <span class="at">label =</span> species_label),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">21</span>),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_CVtRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> means_WBIO, <span class="at">data =</span> coefs_Boot_CVt_RBD_WBIO)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_CVtRBDWBIO)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_CVtRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-pi-cv-rbd-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-pi-cv-rbd-over-wbio">Bootstrap PI : CV RBD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-40"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-40-1"><a href="#annotated-cell-40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="annotated-cell-40-2"><a href="#annotated-cell-40-2" aria-hidden="true" tabindex="-1"></a>Boot_PIvCvt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="annotated-cell-40-3"><a href="#annotated-cell-40-3" aria-hidden="true" tabindex="-1"></a>  PIvCVtRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="annotated-cell-40-4"><a href="#annotated-cell-40-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-40-5"><a href="#annotated-cell-40-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="annotated-cell-40-6"><a href="#annotated-cell-40-6" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvCVtRBD_WBIO))</span>
<span id="annotated-cell-40-7"><a href="#annotated-cell-40-7" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> combin_split_PIvCVtRBD_WBIO[,.(<span class="at">means_RBD =</span> <span class="fu">mean</span>(RBD_n_cm),</span>
<span id="annotated-cell-40-8"><a href="#annotated-cell-40-8" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="annotated-cell-40-9"><a href="#annotated-cell-40-9" aria-hidden="true" tabindex="-1"></a>                                               by <span class="ot">=</span> .(species, h2o)]</span>
<span id="annotated-cell-40-10"><a href="#annotated-cell-40-10" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO[, PIvRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RBD) <span class="sc">-</span> <span class="fu">min</span>(means_RBD)) <span class="sc">/</span> <span class="fu">max</span>(means_RBD),</span>
<span id="annotated-cell-40-11"><a href="#annotated-cell-40-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="annotated-cell-40-12"><a href="#annotated-cell-40-12" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> means_RBD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="annotated-cell-40-13"><a href="#annotated-cell-40-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PIvRBD =</span> <span class="fu">mean</span>(PIvRBD)), by <span class="ot">=</span> species]</span>
<span id="annotated-cell-40-14"><a href="#annotated-cell-40-14" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRBD_WBIO[, CVtRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RBD_n_cm) <span class="sc">/</span> <span class="fu">mean</span>(RBD_n_cm)),</span>
<span id="annotated-cell-40-15"><a href="#annotated-cell-40-15" aria-hidden="true" tabindex="-1"></a>                              by <span class="ot">=</span> species]</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="8" onclick="event.preventDefault();" href="">8</a><span id="annotated-cell-40-16" class="code-annotation-target"><a href="#annotated-cell-40-16" aria-hidden="true" tabindex="-1"></a>  mean_CVt <span class="ot">=</span> <span class="fu">unique</span>(combin_split_PIvCVtRBD_WBIO[, <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"CVtRBD"</span>)])</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="9" onclick="event.preventDefault();" href="">9</a><span id="annotated-cell-40-17" class="code-annotation-target"><a href="#annotated-cell-40-17" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">=</span> <span class="fu">merge</span>(means_RBD_WBIO, mean_CVt, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="annotated-cell-40-18"><a href="#annotated-cell-40-18" aria-hidden="true" tabindex="-1"></a>  matched_data[, PIv_CVt_ratio <span class="sc">:</span><span class="er">=</span> PIvRBD <span class="sc">/</span> CVtRBD]</span>
<span id="annotated-cell-40-19"><a href="#annotated-cell-40-19" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">&lt;-</span> matched_data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matched_data),</span>
<span id="annotated-cell-40-20"><a href="#annotated-cell-40-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(matched_data),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="10" onclick="event.preventDefault();" href="">10</a><span id="annotated-cell-40-21" class="code-annotation-target"><a href="#annotated-cell-40-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="annotated-cell-40-22"><a href="#annotated-cell-40-22" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvCVtRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIv_CVt_ratio <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> matched_data)</span>
<span id="annotated-cell-40-23"><a href="#annotated-cell-40-23" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> matched_data<span class="sc">$</span>mean_means_WBIO,</span>
<span id="annotated-cell-40-24"><a href="#annotated-cell-40-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> matched_data<span class="sc">$</span>species,</span>
<span id="annotated-cell-40-25"><a href="#annotated-cell-40-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvCVtRBDWBIO))</span>
<span id="annotated-cell-40-26"><a href="#annotated-cell-40-26" aria-hidden="true" tabindex="-1"></a>})</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-40" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="16" data-code-annotation="8">Need 6 unique values for each species, above were duplicated 8 times</span>
</dd>
<dt data-target-cell="annotated-cell-40" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="17" data-code-annotation="9">Match values per species</span>
</dd>
<dt data-target-cell="annotated-cell-40" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="21" data-code-annotation="10">Optionally bootstrap species before doing the regression</span>
</dd>
</dl>
</div>
</div>
<p>Store the results in a <code>data.table</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIvCvt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIvCvt_RBD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Produce the plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>PIvCVt_RBD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_PIvCvt_RBD_WBIO,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(mean_means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">350</span>, <span class="at">y =</span> <span class="fl">1.8</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_PIvCvt_RBD_WBIO)),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(PI <span class="sc">~</span><span class="st">":"</span><span class="sc">~</span> CV <span class="sc">~</span> RBD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>n <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> PI_CV_RBD, <span class="at">label =</span> species_label),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">21</span>),</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the linear regression to extract results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_PIvCVtRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_PIvCvt_RBD_WBIO)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_PIvCVtRBDWBIO)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_PIvCVtRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-cvm-rbd-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-cvm-rbd-over-wbio">Bootstrap CVm RBD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Boot_CVm_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  CVmRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  combin_split_CVmRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVmRBD_WBIO))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> combin_split_CVmRBD_WBIO[,.(<span class="at">means_RBD =</span> <span class="fu">mean</span>(RBD_n_cm),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO[, CVmRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(means_RBD) <span class="sc">/</span> <span class="fu">mean</span>(means_RBD)),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  CVm_RBD_WBIO <span class="ot">=</span> means_RBD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">CVmRBD =</span> <span class="fu">mean</span>(CVmRBD)), by <span class="ot">=</span> species]</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  CVm_RBD_WBIO <span class="ot">&lt;-</span> CVm_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVm_RBD_WBIO),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVm_RBD_WBIO),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVmRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVmRBD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> CVm_RBD_WBIO)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> CVm_RBD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVm_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVmRBDWBIO))</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVm_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVm_RBD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>CVm_RBD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_CVm_RBD_WBIO,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(mean_means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">350</span>, <span class="at">y =</span> <span class="fl">0.8</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_CVm_RBD_WBIO)),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(CVm <span class="sc">~</span> RBD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>n <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> CVm_RBD,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> species_label),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">21</span>),</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_CVmRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_CVm_RBD_WBIO)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_CVmRBDWBIO)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_CVmRBDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arrange-multiplot-rbd" class="level2">
<h2 class="anchored" data-anchor-id="arrange-multiplot-rbd">Arrange multiplot RBD</h2>
<p>To display the bootstrap results in a way that does not take up too much space, we need to produce a multiplot. Again, we can ignore the <code>geom_smooth()</code> warning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>RBD_PIvCVtCVmPICV <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(PIv_RBD_plot, CVt_RBD_plot,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                                        PIvCVt_RBD_plot, CVm_RBD_plot,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_size =</span> <span class="dv">25</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_fontfamily =</span> <span class="st">"arial"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_colour =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create common x-axis label</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x.grob_wbio <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fontsize =</span> <span class="dv">32</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add common x-axis label and produce the multiplot. Of course, we would need to adjust the plot size accordingly to our window size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(RBD_PIvCVtCVmPICV, <span class="at">bottom =</span> x.grob_wbio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Overall output table for our linear models. The variables (PIv, CVt, PI:CV, and CVm) are not named in the table below. However, based on their order in the above bootstrap’s, we know that: 1) PIv, 2) CVt, 3) PI:CV, 4) CVm</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(stats_lm_boot_PIvRBDWBIO, stats_lm_boot_CVtRBDWBIO,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                  stats_lm_boot_PIvCVtRBDWBIO, stats_lm_boot_CVmRBDWBIO,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1943</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1904&nbsp;–&nbsp;0.1982</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0844</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0821&nbsp;–&nbsp;0.0867</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">1.0759</td>
<td style="text-align: center;">1.0666&nbsp;–&nbsp;1.0853</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">0.1699</td>
<td style="text-align: center;">0.1661&nbsp;–&nbsp;0.1738</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">mean means WBIO</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0003</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0003&nbsp;–&nbsp;0.0003</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.0005</td>
<td style="text-align: center;">-0.0006&nbsp;–&nbsp;-0.0005</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">0.0003</td>
<td style="text-align: center;">0.0003&nbsp;–&nbsp;0.0003</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">means WBIO</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0008</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0007&nbsp;–&nbsp;0.0008</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.072 / 0.072</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.540 / 0.540</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.037 / 0.037</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.060 / 0.060</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="bootstrap-piv-rld-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-piv-rld-over-wbio">Bootstrap PIv RLD over WBIO</h2>
<p>For Root length density (RLD; cm cm<sup>-3</sup>) we run exactly the same loop(s) as for RBD.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Boot_PIv_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  PIvRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvRLD_WBIO))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_PIvRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, PIvRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RLD) <span class="sc">-</span> <span class="fu">min</span>(means_RLD)) <span class="sc">/</span> <span class="fu">max</span>(means_RLD),</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  PIv_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">PIvRLD =</span> <span class="fu">mean</span>(PIvRLD)), by <span class="ot">=</span> species]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  PIv_RLD_WBIO <span class="ot">&lt;-</span> PIv_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(PIv_RLD_WBIO),</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(PIv_RLD_WBIO),</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIvRLD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> PIv_RLD_WBIO)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> PIv_RLD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> PIv_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvRLDWBIO))</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIv_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIv_RLD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>PIv_RLD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_PIv_RLD_WBIO,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(mean_means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="fl">0.8</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_PIv_RLD_WBIO)),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(PIv <span class="sc">~</span> RLD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>cm <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-3"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> PIv_RLD,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> species_label),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_PIvRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_PIv_RLD_WBIO)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stats_lm_boot_PIvRLDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_PIvRLDWBIO)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_PIvRLDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-cvt-rld-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-cvt-rld-over-wbio">Bootstrap CVt RLD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>Boot_CVt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  CVtRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  combin_split_CVtRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVtRLD_WBIO))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  RLD_WBIO <span class="ot">=</span> combin_split_CVtRLD_WBIO[,.(<span class="at">RLD =</span> (RLD_CM_cm3),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">WBIO =</span> (WBIO)),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                                      by <span class="ot">=</span> .(species)]</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  RLD_WBIO[, CVtRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RLD) <span class="sc">/</span> <span class="fu">mean</span>(RLD)),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>           by <span class="ot">=</span> species]</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  CVt_RLD_WBIO <span class="ot">=</span> RLD_WBIO[,.(<span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">CVtRLD =</span> <span class="fu">mean</span>(CVtRLD)), by <span class="ot">=</span> species]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  CVt_RLD_WBIO <span class="ot">&lt;-</span> CVt_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVt_RLD_WBIO),</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVt_RLD_WBIO),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVtRLD <span class="sc">~</span> means_WBIO, <span class="at">data =</span> CVt_RLD_WBIO)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">means_WBIO =</span> CVt_RLD_WBIO<span class="sc">$</span>means_WBIO,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVt_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVtRLDWBIO))</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVt_RLD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>CVt_RLD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_CVt_RLD_WBIO,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">280</span>, <span class="at">y =</span> <span class="fl">0.75</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> means_WBIO,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_CVt_RLD_WBIO)),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(CVt <span class="sc">~</span> RLD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>cm <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-3"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> CVt_RLD,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> species_label),</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_CVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> means_WBIO, <span class="at">data =</span> coefs_Boot_CVt_RLD_WBIO)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_CVtRLDWBIO)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_CVtRLDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-pi-cv-rld-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-pi-cv-rld-over-wbio">Bootstrap PI : CV RLD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Boot_PIvCvt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  PIvCVtRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvCVtRLD_WBIO))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_PIvCVtRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                                               by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, PIvRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RLD) <span class="sc">-</span> <span class="fu">min</span>(means_RLD)) <span class="sc">/</span> <span class="fu">max</span>(means_RLD),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PIvRLD =</span> <span class="fu">mean</span>(PIvRLD)), by <span class="ot">=</span> species]</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRLD_WBIO[, CVtRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RLD_CM_cm3) <span class="sc">/</span> <span class="fu">mean</span>(RLD_CM_cm3)),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>                              by <span class="ot">=</span> species]</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  mean_CVt <span class="ot">=</span> <span class="fu">unique</span>(combin_split_PIvCVtRLD_WBIO[, <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"CVtRLD"</span>)])</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">=</span> <span class="fu">merge</span>(means_RLD_WBIO, mean_CVt, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  matched_data[, PIv_CVt_ratio <span class="sc">:</span><span class="er">=</span> PIvRLD <span class="sc">/</span> CVtRLD]</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">&lt;-</span> matched_data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matched_data),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(matched_data),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvCVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIv_CVt_ratio <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> matched_data)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> matched_data<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> matched_data<span class="sc">$</span>species,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvCVtRLDWBIO))</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIvCvt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIvCvt_RLD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>PIvCVt_RLD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_PIvCvt_RLD_WBIO,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(mean_means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">350</span>, <span class="at">y =</span> <span class="fl">1.7</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_PIvCvt_RLD_WBIO)),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(PI <span class="sc">~</span><span class="st">":"</span><span class="sc">~</span> CV <span class="sc">~</span> RLD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>cm <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-3"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> PI_CV_RLD,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> species_label),</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_PIvCVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_PIvCvt_RLD_WBIO)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_PIvCVtRLDWBIO)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_PIvCVtRLDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-cvm-rld-over-wbio" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-cvm-rld-over-wbio">Bootstrap CVm RLD over WBIO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Boot_CVm_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  CVmRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  combin_split_CVmRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVmRLD_WBIO))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_CVmRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, CVmRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(means_RLD) <span class="sc">/</span> <span class="fu">mean</span>(means_RLD)),</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  CVm_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">CVmRLD =</span> <span class="fu">mean</span>(CVmRLD)), by <span class="ot">=</span> species]</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  CVm_RLD_WBIO <span class="ot">&lt;-</span> CVm_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVm_RLD_WBIO),</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVm_RLD_WBIO),</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVmRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVmRLD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> CVm_RLD_WBIO)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> CVm_RLD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVm_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVmRLDWBIO))</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVm_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVm_RLD_WBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>CVm_RLD_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coefs_Boot_CVm_RLD_WBIO,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(mean_means_WBIO, y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="fl">0.9</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">lm_eqn</span>(<span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> coefs_Boot_CVm_RLD_WBIO)),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(CVm <span class="sc">~</span> RLD <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>cm <span class="sc">~</span> cm<span class="sc">^</span><span class="st">"-3"</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Plast_abs_sp_traits,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> WBIO, <span class="at">y =</span> CVm_RLD,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> species_label),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>stats_lm_boot_CVmRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> coefs_Boot_CVm_RLD_WBIO)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stats_lm_boot_CVmRLDWBIO)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stats_lm_boot_CVmRLDWBIO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arrange-multiplot-rld" class="level2">
<h2 class="anchored" data-anchor-id="arrange-multiplot-rld">Arrange multiplot RLD</h2>
<p>To display the bootstrap results in a way that does not take up too much space, we need to produce a multiplot. Again, we can ignore the <code>geom_smooth()</code> warning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>RLD_PIvCVtCVmPICV <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(PIv_RLD_plot, CVt_RLD_plot,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                                        PIvCVt_RLD_plot, CVm_RLD_plot,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_size =</span> <span class="dv">25</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_fontfamily =</span> <span class="st">"arial"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">label_colour =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create common x-axis label –&gt; <code>"x.grob_wbio"</code> specified above!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(RLD_PIvCVtCVmPICV, <span class="at">bottom =</span> x.grob_wbio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="IDENT_SSM_rootTrait_plasticity_Jaeger_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Overall output table for our linear models. The variables (PIv, CVt, PI:CV, and CVm) are not named in the table below. However, based on their order in the above bootstrap’s, we know that: 1) PIv, 2) CVt, 3) PI:CV, 4) CVm</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(stats_lm_boot_PIvRLDWBIO, stats_lm_boot_CVtRLDWBIO,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                  stats_lm_boot_PIvCVtRLDWBIO, stats_lm_boot_CVmRLDWBIO,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">y</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1873</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1838&nbsp;–&nbsp;0.1909</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1290</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.1265&nbsp;–&nbsp;0.1315</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">1.0951</td>
<td style="text-align: center;">1.0878&nbsp;–&nbsp;1.1024</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">0.1349</td>
<td style="text-align: center;">0.1313&nbsp;–&nbsp;0.1385</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">mean means WBIO</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0003</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0003&nbsp;–&nbsp;0.0004</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.0006</td>
<td style="text-align: center;">-0.0006&nbsp;–&nbsp;-0.0006</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">0.0004</td>
<td style="text-align: center;">0.0004&nbsp;–&nbsp;0.0004</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">means WBIO</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0006</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.0006&nbsp;–&nbsp;0.0006</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">36000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.097 / 0.097</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.399 / 0.399</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.074 / 0.074</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.119 / 0.119</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>We explored all the other absorptive fine root trait relationships with above ground woody biomass. None of these relationships showed strong <span class="math inline">\(R^2\)</span> values.</strong></p>
</section>
</section>
<section id="invitation-for-collaboration" class="level1">
<h1>Invitation for collaboration</h1>
<p>We welcome feedback, collaboration, and further research based on this study. If you have any questions, suggestions, or would like to collaborate on extending this work, please contact us. For a detailed discussion and conclusion, please refer to the main research paper.</p>
<section id="reproduction-guidelines-and-further-research" class="level2">
<h2 class="anchored" data-anchor-id="reproduction-guidelines-and-further-research">Reproduction guidelines and further research</h2>
<p>To reproduce the analyses presented in this study:</p>
<ol type="1">
<li>Download the data from <a href="https://github.com/Florentin85/Data_code_rootTraits_IDENT-SSM">GitHUb</a>.</li>
<li>Clone the <a href="https://github.com/Florentin85/Data_code_rootTraits_IDENT-SSM">code repository</a>.</li>
<li>Follow the instructions in the README file to set up the environment and run the analyses.</li>
</ol>
<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tobnerInterspecificCoordinationIntraspecific2013" class="csl-entry" role="listitem">
Tobner, Cornelia M., Alain Paquette, and Christian Messier. 2013. <span>“Interspecific Coordination and Intraspecific Plasticity of Fine Root Traits in <span>North American</span> Temperate Tree Species.”</span> <em>Frontiers in Plant Science</em> 4. <a href="https://doi.org/10.3389/fpls.2013.00242">https://doi.org/10.3389/fpls.2013.00242</a>.
</div>
<div id="ref-valladaresQuantitativeEstimationPhenotypic2006" class="csl-entry" role="listitem">
Valladares, Fernando, David Sanchez-Gomez, and Miguel A. Zavala. 2006. <span>“Quantitative Estimation of Phenotypic Plasticity: Bridging the Gap Between the Evolutionary Concept and Its Ecological Applications.”</span> <em>Journal of Ecology</em> 94 (6): 1103–16. <a href="https://doi.org/10.1111/j.1365-2745.2006.01176.x">https://doi.org/10.1111/j.1365-2745.2006.01176.x</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb74" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Young temperate tree species show fine-root trait acclimation to differences in water availability"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Data preparation and computation of absorptive fine root trait plasticity"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Florentin C. Jaeger"</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "Université du Québec à Montréal"</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "jaeger.florentin_clemens@courrier.uqam.ca"</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true  # Table of contents enabled</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false  # Collapsible code sections</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true  # Show/hide code tools</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-06-27"</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> "/home/florentin/Zotero/My Library.bib"</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> superhero</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preparation</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load the libraries</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load the data</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>Absorptive fine root trait table from previous R script</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>absorptive <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"absorptive.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">strip.white =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"NA"</span>,<span class="st">""</span>))</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>Above ground data to regress absorptive fine root trait plasticity</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>over woody biomass (WBIO)</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"above_ground_fall2018.core.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip.white =</span> <span class="cn">TRUE</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"NA"</span>,<span class="st">""</span>))</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Clean and organise the above ground data</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(above_ground)</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>We can see that not all data columns have the proper format, so we need to</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>adjust this for downstream analysis. In the next step we <span class="in">`subset`</span> only the alive trees.</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>We will replace the existing <span class="in">`data.frame "above_ground"`</span></span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> <span class="fu">subset</span>(above_ground, status6_live_dead <span class="sc">!=</span> <span class="st">"dead"</span>)</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>Rename and factorize sp and H~2~O</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(above_ground)[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="st">"species"</span></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span></span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(above_ground,</span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">species =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">"BEPA"</span> <span class="sc">~</span> <span class="st">"Betula papyrifera"</span>,</span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"QURU"</span> <span class="sc">~</span> <span class="st">"Quercus rubra"</span>,</span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"ACSA"</span> <span class="sc">~</span> <span class="st">"Acer saccharum"</span>,</span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"LALA"</span> <span class="sc">~</span> <span class="st">"Larix laricina"</span>,</span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"PIST"</span> <span class="sc">~</span> <span class="st">"Pinus strobus"</span>,</span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a>                                    species <span class="sc">==</span> <span class="st">"PIGL"</span> <span class="sc">~</span> <span class="st">"Picea glauca"</span>))</span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>above_ground<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(above_ground<span class="sc">$</span>species,</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Betula papyrifera"</span>,</span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Quercus rubra"</span>,</span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Acer saccharum"</span>,</span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Larix laricina"</span>,</span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Pinus strobus"</span>,</span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Picea glauca"</span>))</span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a>above_ground <span class="ot">&lt;-</span> above_ground <span class="sc">%&gt;%</span></span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">h2o =</span> <span class="fu">case_when</span>(h2o <span class="sc">==</span> <span class="st">"H"</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>                         h2o <span class="sc">==</span> <span class="st">"L"</span> <span class="sc">~</span> <span class="st">"Low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">h2o =</span> <span class="fu">factor</span>(h2o, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Low"</span>)))</span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a>Tree height (cm) was of data type character, so we need to change it to numeric</span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a><span class="in">above_ground$ht_cm &lt;- as.numeric(above_ground$ht_cm)</span></span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>In order to join the above ground with the below ground table, we need a unique key.</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>This key could be the combination of block and plot. The <span class="in">`data.frame "absorptive"`</span></span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>already has this key, so we only need to generate it for <span class="in">`"above_ground"`</span>, akin to</span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>the concatenate function in MS Excel.</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a>above_ground<span class="sc">$</span>block_plot <span class="ot">&lt;-</span> <span class="fu">paste</span>(above_ground<span class="sc">$</span>block,</span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a>                                 above_ground<span class="sc">$</span>plot,</span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a>It's best to use type "character" for <span class="in">`join`</span></span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a>absorptive<span class="sc">$</span>block_plot <span class="ot">&lt;-</span> <span class="fu">as.character</span>(absorptive<span class="sc">$</span>block_plot)</span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute means on plot level (48 plots)</span></span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>Absorptive fine roots</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE}</span></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a><span class="in">absorptive_level_plot &lt;- absorptive %&gt;%</span></span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::select(block, block_plot, species, h2o, Soil_depth, FRB_g_cm3, SRL_m_g,</span></span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a><span class="in">                length_aff_cm, avgdiam_mm, rootvol_aff_class_cm3, RTD_g_cm3,</span></span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a><span class="in">                ntips_length_n_cm, RDMC_dry_g_fresh_g, SRA_cm2_g, RLD_cm_cm3) %&gt;%</span></span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(species, h2o, block, block_plot) %&gt;%</span></span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit() %&gt;%</span></span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::summarise(FRB_G_cm3 = mean (FRB_g_cm3),</span></span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a><span class="in">                   SRL_m_g = mean (SRL_m_g),</span></span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a><span class="in">                   LENGTH_aff_cm = mean (length_aff_cm),</span></span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a><span class="in">                   Diam_mm = mean (avgdiam_mm),</span></span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a><span class="in">                   Vol_aff_class_cm3 = mean (rootvol_aff_class_cm3),</span></span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a><span class="in">                   RTD_G_cm3 = mean (RTD_g_cm3),</span></span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a><span class="in">                   RBD_n_cm = mean (ntips_length_n_cm),</span></span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a><span class="in">                   RDMC_g_g = mean (RDMC_dry_g_fresh_g),</span></span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a><span class="in">                   SRA_CM2_g = mean (SRA_cm2_g),</span></span>
<span id="cb74-130"><a href="#cb74-130" aria-hidden="true" tabindex="-1"></a><span class="in">                   RLD_CM_cm3 = mean (RLD_cm_cm3)) %&gt;%</span></span>
<span id="cb74-131"><a href="#cb74-131" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::mutate(group = interaction(block, block_plot, species, species = "_"))</span></span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>Factorize and make sure the order is correct</span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>absorptive_level_plot<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(absorptive_level_plot<span class="sc">$</span>species,</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Betula papyrifera"</span>,</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Quercus rubra"</span>,</span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Acer saccharum"</span>,</span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Larix laricina"</span>,</span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Pinus strobus"</span>,</span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"Picea glauca"</span>))</span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-145"><a href="#cb74-145" aria-hidden="true" tabindex="-1"></a>absorptive_level_plot<span class="sc">$</span>h2o <span class="ot">&lt;-</span> <span class="fu">factor</span>(absorptive_level_plot<span class="sc">$</span>h2o,</span>
<span id="cb74-146"><a href="#cb74-146" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"High"</span>,</span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Low"</span>))</span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a>Above ground</span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE}</span></span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a><span class="in">aboveground_level_plot &lt;- above_ground %&gt;%</span></span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::select(block, block_plot, species, h2o, ht_cm, lbio, agbio, wbio) %&gt;%</span></span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(species, h2o, block, block_plot) %&gt;%</span></span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit() %&gt;%</span></span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::summarise(HT_cm = mean (ht_cm),</span></span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a><span class="in">                   LBIO = mean (lbio),</span></span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a><span class="in">                   AGBIO = mean (agbio),</span></span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a><span class="in">                   WBIO = mean (wbio)) %&gt;%</span></span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::mutate(group = interaction(block, block_plot, species, species = "_"))</span></span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Join above- and below ground</span></span>
<span id="cb74-164"><a href="#cb74-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(absorptive_level_plot,</span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a>                                   aboveground_level_plot,</span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">by =</span> <span class="fu">join_by</span>(block_plot))</span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>Inspect the outcome</span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(absorptive_above_plot)</span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a>We can remove obsolete variables (columns)</span>
<span id="cb74-178"><a href="#cb74-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-179"><a href="#cb74-179" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>group.x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>species.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>h2o.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>block.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a>absorptive_above_plot<span class="sc">$</span>group.y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>Rename variables to remove appended "x"</span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"species"</span></span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"h2o"</span></span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(absorptive_above_plot)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"block"</span></span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Function to display linear model</span></span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a>(LM; plasticity over WBIO)</span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a>In the <span class="in">`ggplot()`</span> figure below we will be using the function <span class="in">`lm_eqn`</span> to annotate</span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a>the plot with the regression formula.</span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a>lm_eqn <span class="ot">=</span> <span class="cf">function</span>(m) {</span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">format</span>(<span class="fu">coef</span>(m)[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">format</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(m)[[<span class="dv">2</span>]]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a>            <span class="at">r2 =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared)); <span class="co"># &lt;1&gt;</span></span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">coef</span>(m)[[<span class="dv">2</span>]] <span class="sc">&gt;=</span> <span class="dv">0</span>)  {</span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="fu">italic</span>(y) <span class="sc">==</span> a <span class="sc">+</span> b <span class="sc">%.%</span> <span class="fu">italic</span>(x)<span class="sc">*</span><span class="st">","</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(r)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">"="</span><span class="sc">~</span>r2,l)</span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="fu">italic</span>(y) <span class="sc">==</span> a <span class="sc">-</span> b <span class="sc">%.%</span> <span class="fu">italic</span>(x)<span class="sc">*</span><span class="st">","</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(r)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">"="</span><span class="sc">~</span>r2,l)</span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="fu">as.expression</span>(eq));</span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$R^2$ with two decimal places</span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-214"><a href="#cb74-214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compute individual (species level) plasticity</span></span>
<span id="cb74-215"><a href="#cb74-215" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coefficient of variation</span></span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a>\text{CV} = \frac{\text{STDEV}(x)}{\text{MEAN}(x)}</span>
<span id="cb74-218"><a href="#cb74-218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb74-219"><a href="#cb74-219" aria-hidden="true" tabindex="-1"></a>The coefficient of variation (CV) is calculated on a different level than PI. That means across all 8 species values (across both H~2~O treatments, high vs. low).</span>
<span id="cb74-222"><a href="#cb74-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-223"><a href="#cb74-223" aria-hidden="true" tabindex="-1"></a>CVt_traits <span class="ot">&lt;-</span> absorptive_above_plot <span class="sc">%&gt;%</span></span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, h2o, RLD_CM_cm3, SRL_m_g, SRA_CM2_g,</span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a>                RTD_G_cm3, RBD_n_cm, WBIO) <span class="sc">%&gt;%</span></span>
<span id="cb74-226"><a href="#cb74-226" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb74-227"><a href="#cb74-227" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">CVt_RLD =</span> ((<span class="fu">sd</span> (RLD_CM_cm3)) <span class="sc">/</span> (<span class="fu">mean</span> (RLD_CM_cm3))),</span>
<span id="cb74-228"><a href="#cb74-228" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_SRL =</span> ((<span class="fu">sd</span> (SRL_m_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRL_m_g))),</span>
<span id="cb74-229"><a href="#cb74-229" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_RTD =</span> ((<span class="fu">sd</span> (RTD_G_cm3)) <span class="sc">/</span> (<span class="fu">mean</span> (RTD_G_cm3))),</span>
<span id="cb74-230"><a href="#cb74-230" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_RBD =</span> ((<span class="fu">sd</span> (RBD_n_cm)) <span class="sc">/</span> (<span class="fu">mean</span> (RBD_n_cm))),</span>
<span id="cb74-231"><a href="#cb74-231" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_SRA =</span> ((<span class="fu">sd</span> (SRA_CM2_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRA_CM2_g))),</span>
<span id="cb74-232"><a href="#cb74-232" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVt_WBIO =</span> ((<span class="fu">sd</span> (WBIO)) <span class="sc">/</span> (<span class="fu">mean</span> (WBIO))))</span>
<span id="cb74-233"><a href="#cb74-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-234"><a href="#cb74-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## PIv, CVm, and PI : CV</span></span>
<span id="cb74-235"><a href="#cb74-235" aria-hidden="true" tabindex="-1"></a>Calculate the means per species and H~2~O treatment to calculate PIv, CVm, and PI : CV downstream.</span>
<span id="cb74-236"><a href="#cb74-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE}</span></span>
<span id="cb74-237"><a href="#cb74-237" aria-hidden="true" tabindex="-1"></a><span class="in">abs_ab_means_sph2o &lt;- absorptive_above_plot %&gt;%</span></span>
<span id="cb74-238"><a href="#cb74-238" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::select(species, h2o, RLD_CM_cm3, SRL_m_g, SRA_CM2_g,</span></span>
<span id="cb74-239"><a href="#cb74-239" aria-hidden="true" tabindex="-1"></a><span class="in">                RTD_G_cm3, RBD_n_cm, WBIO) %&gt;%</span></span>
<span id="cb74-240"><a href="#cb74-240" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(species, h2o) %&gt;%</span></span>
<span id="cb74-241"><a href="#cb74-241" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit() %&gt;%</span></span>
<span id="cb74-242"><a href="#cb74-242" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::summarise(RLD_CM_CM3 = mean (RLD_CM_cm3),</span></span>
<span id="cb74-243"><a href="#cb74-243" aria-hidden="true" tabindex="-1"></a><span class="in">                   SRL_M_g = mean (SRL_m_g),</span></span>
<span id="cb74-244"><a href="#cb74-244" aria-hidden="true" tabindex="-1"></a><span class="in">                   RTD_G_CM3 = mean (RTD_G_cm3),</span></span>
<span id="cb74-245"><a href="#cb74-245" aria-hidden="true" tabindex="-1"></a><span class="in">                   RBD_n_cm = mean (RBD_n_cm),</span></span>
<span id="cb74-246"><a href="#cb74-246" aria-hidden="true" tabindex="-1"></a><span class="in">                   SRA_CM2_G = mean (SRA_CM2_g),</span></span>
<span id="cb74-247"><a href="#cb74-247" aria-hidden="true" tabindex="-1"></a><span class="in">                   WBIO = mean (WBIO)) %&gt;%</span></span>
<span id="cb74-248"><a href="#cb74-248" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr::mutate(group = interaction(species, h2o, species = "_"))</span></span>
<span id="cb74-249"><a href="#cb74-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-250"><a href="#cb74-250" aria-hidden="true" tabindex="-1"></a>Calculate PIv and CVm based on means <span class="co">[</span><span class="ot">@valladaresQuantitativeEstimationPhenotypic2006</span><span class="co">]</span>.</span>
<span id="cb74-253"><a href="#cb74-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-254"><a href="#cb74-254" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> abs_ab_means_sph2o <span class="sc">%&gt;%</span></span>
<span id="cb74-255"><a href="#cb74-255" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, h2o, RLD_CM_CM3, SRL_M_g, RTD_G_CM3, RBD_n_cm,</span>
<span id="cb74-256"><a href="#cb74-256" aria-hidden="true" tabindex="-1"></a>                SRA_CM2_G, WBIO) <span class="sc">%&gt;%</span></span>
<span id="cb74-257"><a href="#cb74-257" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb74-258"><a href="#cb74-258" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">PIv_RLD =</span> ((<span class="fu">max</span>(RLD_CM_CM3) <span class="sc">-</span> <span class="fu">min</span>(RLD_CM_CM3)) <span class="sc">/</span> <span class="fu">max</span>(RLD_CM_CM3)),</span>
<span id="cb74-259"><a href="#cb74-259" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_SRL =</span> ((<span class="fu">max</span>(SRL_M_g) <span class="sc">-</span> <span class="fu">min</span>(SRL_M_g)) <span class="sc">/</span> <span class="fu">max</span>(SRL_M_g)),</span>
<span id="cb74-260"><a href="#cb74-260" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_RTD =</span> ((<span class="fu">max</span>(RTD_G_CM3) <span class="sc">-</span> <span class="fu">min</span>(RTD_G_CM3)) <span class="sc">/</span> <span class="fu">max</span>(RTD_G_CM3)),</span>
<span id="cb74-261"><a href="#cb74-261" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_RBD =</span> ((<span class="fu">max</span>(RBD_n_cm) <span class="sc">-</span> <span class="fu">min</span>(RBD_n_cm)) <span class="sc">/</span> <span class="fu">max</span>(RBD_n_cm)),</span>
<span id="cb74-262"><a href="#cb74-262" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_SRA =</span> ((<span class="fu">max</span>(SRA_CM2_G) <span class="sc">-</span> <span class="fu">min</span>(SRA_CM2_G)) <span class="sc">/</span> <span class="fu">max</span>(SRA_CM2_G)),</span>
<span id="cb74-263"><a href="#cb74-263" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PIv_WBIO =</span> ((<span class="fu">max</span>(WBIO) <span class="sc">-</span> <span class="fu">min</span>(WBIO)) <span class="sc">/</span> <span class="fu">max</span>(WBIO)),</span>
<span id="cb74-264"><a href="#cb74-264" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RLD =</span> ((<span class="fu">sd</span> (RLD_CM_CM3)) <span class="sc">/</span> (<span class="fu">mean</span> (RLD_CM_CM3))),</span>
<span id="cb74-265"><a href="#cb74-265" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_SRL =</span> ((<span class="fu">sd</span> (SRL_M_g)) <span class="sc">/</span> (<span class="fu">mean</span> (SRL_M_g))),</span>
<span id="cb74-266"><a href="#cb74-266" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RTD =</span> ((<span class="fu">sd</span> (RTD_G_CM3)) <span class="sc">/</span> (<span class="fu">mean</span> (RTD_G_CM3))),</span>
<span id="cb74-267"><a href="#cb74-267" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_RBD =</span> ((<span class="fu">sd</span> (RBD_n_cm)) <span class="sc">/</span> (<span class="fu">mean</span> (RBD_n_cm))),</span>
<span id="cb74-268"><a href="#cb74-268" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_SRA =</span> ((<span class="fu">sd</span> (SRA_CM2_G)) <span class="sc">/</span> (<span class="fu">mean</span> (SRA_CM2_G))),</span>
<span id="cb74-269"><a href="#cb74-269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CVm_WBIO =</span> ((<span class="fu">sd</span> (WBIO)) <span class="sc">/</span> (<span class="fu">mean</span> (WBIO))),</span>
<span id="cb74-270"><a href="#cb74-270" aria-hidden="true" tabindex="-1"></a>                   <span class="at">WBIO =</span> <span class="fu">mean</span> (WBIO))</span>
<span id="cb74-271"><a href="#cb74-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-272"><a href="#cb74-272" aria-hidden="true" tabindex="-1"></a>Join the CVt to the PIv and CVm</span>
<span id="cb74-275"><a href="#cb74-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-276"><a href="#cb74-276" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Plast_abs_sp_traits,</span>
<span id="cb74-277"><a href="#cb74-277" aria-hidden="true" tabindex="-1"></a>                                 CVt_traits,</span>
<span id="cb74-278"><a href="#cb74-278" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">by =</span> <span class="fu">join_by</span>(species))</span>
<span id="cb74-279"><a href="#cb74-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-280"><a href="#cb74-280" aria-hidden="true" tabindex="-1"></a>Calculate the ratio of the PI to the CV:</span>
<span id="cb74-281"><a href="#cb74-281" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb74-282"><a href="#cb74-282" aria-hidden="true" tabindex="-1"></a>\frac{\text{PI}}{\text{CV}}</span>
<span id="cb74-283"><a href="#cb74-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb74-284"><a href="#cb74-284" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@tobnerInterspecificCoordinationIntraspecific2013</span><span class="co">]</span></span>
<span id="cb74-285"><a href="#cb74-285" aria-hidden="true" tabindex="-1"></a>The individual plasticity values (per species) are just for display in the downstream</span>
<span id="cb74-286"><a href="#cb74-286" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> figure, not for the bootstrap itself. The plasticity values are</span>
<span id="cb74-287"><a href="#cb74-287" aria-hidden="true" tabindex="-1"></a>calculated inside the bootstrap again.</span>
<span id="cb74-290"><a href="#cb74-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-291"><a href="#cb74-291" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span> Plast_abs_sp_traits <span class="sc">%&gt;%</span></span>
<span id="cb74-292"><a href="#cb74-292" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">PI_CV_RLD =</span> (PIv_RLD <span class="sc">/</span> CVt_RLD),</span>
<span id="cb74-293"><a href="#cb74-293" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_SRL =</span> (PIv_SRL <span class="sc">/</span> CVt_SRL),</span>
<span id="cb74-294"><a href="#cb74-294" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_RTD =</span> (PIv_RTD <span class="sc">/</span> CVt_RTD),</span>
<span id="cb74-295"><a href="#cb74-295" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_RBD =</span> (PIv_RBD <span class="sc">/</span> CVt_RBD),</span>
<span id="cb74-296"><a href="#cb74-296" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_SRA =</span> (PIv_SRA <span class="sc">/</span> CVt_SRA),</span>
<span id="cb74-297"><a href="#cb74-297" aria-hidden="true" tabindex="-1"></a>                <span class="at">PI_CV_WBIO =</span> (PIv_WBIO <span class="sc">/</span> CVt_WBIO))</span>
<span id="cb74-298"><a href="#cb74-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-299"><a href="#cb74-299" aria-hidden="true" tabindex="-1"></a>Add the short species labels to <span class="in">`"Plast_abs_sp_traits"`</span> to display based on</span>
<span id="cb74-300"><a href="#cb74-300" aria-hidden="true" tabindex="-1"></a>x and y coordinates in downstream <span class="in">`ggplot`</span></span>
<span id="cb74-303"><a href="#cb74-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-304"><a href="#cb74-304" aria-hidden="true" tabindex="-1"></a>Plast_abs_sp_traits <span class="ot">&lt;-</span></span>
<span id="cb74-305"><a href="#cb74-305" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Plast_abs_sp_traits,</span>
<span id="cb74-306"><a href="#cb74-306" aria-hidden="true" tabindex="-1"></a>                 <span class="at">species_label =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">"Betula papyrifera"</span> <span class="sc">~</span> <span class="st">"Bp"</span>,</span>
<span id="cb74-307"><a href="#cb74-307" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Quercus rubra"</span> <span class="sc">~</span> <span class="st">"Qr"</span>,</span>
<span id="cb74-308"><a href="#cb74-308" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Acer saccharum"</span> <span class="sc">~</span> <span class="st">"As"</span>,</span>
<span id="cb74-309"><a href="#cb74-309" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Larix laricina"</span> <span class="sc">~</span> <span class="st">"Ll"</span>,</span>
<span id="cb74-310"><a href="#cb74-310" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Pinus strobus"</span> <span class="sc">~</span> <span class="st">"Ps"</span>,</span>
<span id="cb74-311"><a href="#cb74-311" aria-hidden="true" tabindex="-1"></a>                                           species <span class="sc">==</span> <span class="st">"Picea glauca"</span> <span class="sc">~</span> <span class="st">"Pg"</span>))</span>
<span id="cb74-312"><a href="#cb74-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-313"><a href="#cb74-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-314"><a href="#cb74-314" aria-hidden="true" tabindex="-1"></a><span class="fu"># Plasticity bootstrap traits 0-30 cm soil depth</span></span>
<span id="cb74-315"><a href="#cb74-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparation for bootstrap</span></span>
<span id="cb74-316"><a href="#cb74-316" aria-hidden="true" tabindex="-1"></a>splitting and pasting the <span class="in">`data.frame`</span> in a list</span>
<span id="cb74-319"><a href="#cb74-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-320"><a href="#cb74-320" aria-hidden="true" tabindex="-1"></a>split_sp_h2o <span class="ot">&lt;-</span> <span class="fu">split</span>(absorptive_above_plot,</span>
<span id="cb74-321"><a href="#cb74-321" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste</span>(absorptive_above_plot<span class="sc">$</span>species,</span>
<span id="cb74-322"><a href="#cb74-322" aria-hidden="true" tabindex="-1"></a>                            absorptive_above_plot<span class="sc">$</span>h2o))</span>
<span id="cb74-323"><a href="#cb74-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-324"><a href="#cb74-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-325"><a href="#cb74-325" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap PIv RBD over WBIO</span></span>
<span id="cb74-326"><a href="#cb74-326" aria-hidden="true" tabindex="-1"></a>Define the number of iterations</span>
<span id="cb74-329"><a href="#cb74-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-330"><a href="#cb74-330" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6000</span></span>
<span id="cb74-331"><a href="#cb74-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-332"><a href="#cb74-332" aria-hidden="true" tabindex="-1"></a>It’s important to note that there may be minor, stochastic variations in the bootstrap results presented below compared to those in the research paper.</span>
<span id="cb74-335"><a href="#cb74-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-336"><a href="#cb74-336" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb74-337"><a href="#cb74-337" aria-hidden="true" tabindex="-1"></a>Boot_PIv_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-338"><a href="#cb74-338" aria-hidden="true" tabindex="-1"></a>  PIvRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-339"><a href="#cb74-339" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-340"><a href="#cb74-340" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-341"><a href="#cb74-341" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvRBD_WBIO)) <span class="co"># &lt;2&gt;</span></span>
<span id="cb74-342"><a href="#cb74-342" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> combin_split_PIvRBD_WBIO[,.(<span class="at">means_RBD =</span> <span class="fu">mean</span>(RBD_n_cm),          <span class="co"># &lt;3&gt;</span></span>
<span id="cb74-343"><a href="#cb74-343" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb74-344"><a href="#cb74-344" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb74-345"><a href="#cb74-345" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO[, PIvRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RBD) <span class="sc">-</span> <span class="fu">min</span>(means_RBD)) <span class="sc">/</span> <span class="fu">max</span>(means_RBD),</span>
<span id="cb74-346"><a href="#cb74-346" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]                                                      <span class="co"># &lt;4&gt;</span></span>
<span id="cb74-347"><a href="#cb74-347" aria-hidden="true" tabindex="-1"></a>  PIv_RBD_WBIO <span class="ot">=</span> means_RBD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb74-348"><a href="#cb74-348" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">PIvRBD =</span> <span class="fu">mean</span>(PIvRBD)), by <span class="ot">=</span> species]</span>
<span id="cb74-349"><a href="#cb74-349" aria-hidden="true" tabindex="-1"></a>  PIv_RBD_WBIO <span class="ot">&lt;-</span> PIv_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(PIv_RBD_WBIO),</span>
<span id="cb74-350"><a href="#cb74-350" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(PIv_RBD_WBIO),</span>
<span id="cb74-351"><a href="#cb74-351" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]                             <span class="co"># &lt;5&gt;</span></span>
<span id="cb74-352"><a href="#cb74-352" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIvRBD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> PIv_RBD_WBIO)</span>
<span id="cb74-353"><a href="#cb74-353" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> PIv_RBD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb74-354"><a href="#cb74-354" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> PIv_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-355"><a href="#cb74-355" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvRBDWBIO))</span>
<span id="cb74-356"><a href="#cb74-356" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-357"><a href="#cb74-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-358"><a href="#cb74-358" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Bring the results together</span>
<span id="cb74-359"><a href="#cb74-359" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Compute means for each species and H~2~O treatment</span>
<span id="cb74-360"><a href="#cb74-360" aria-hidden="true" tabindex="-1"></a>(leading comma means subset by columns) <span class="in">`[]`</span> --&gt; contains vector</span>
<span id="cb74-361"><a href="#cb74-361" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Compute PIv for each species. <span class="in">`:=`</span> indicates a new column or updates</span>
<span id="cb74-362"><a href="#cb74-362" aria-hidden="true" tabindex="-1"></a>(from <span class="in">`data.table`</span>). Keep the mean for each species.</span>
<span id="cb74-363"><a href="#cb74-363" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Optionally bootstrap species before doing the regression</span>
<span id="cb74-364"><a href="#cb74-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-365"><a href="#cb74-365" aria-hidden="true" tabindex="-1"></a>Store the results in a <span class="in">`data.table`</span></span>
<span id="cb74-368"><a href="#cb74-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-369"><a href="#cb74-369" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIv_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIv_RBD_WBIO)</span>
<span id="cb74-370"><a href="#cb74-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-371"><a href="#cb74-371" aria-hidden="true" tabindex="-1"></a>Produce the figure</span>
<span id="cb74-372"><a href="#cb74-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-373"><a href="#cb74-373" aria-hidden="true" tabindex="-1"></a><span class="in">PIv_RBD_plot &lt;- ggplot(coefs_Boot_PIv_RBD_WBIO,</span></span>
<span id="cb74-374"><a href="#cb74-374" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(x = mean_means_WBIO, y = y, color = species)) +</span></span>
<span id="cb74-375"><a href="#cb74-375" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-376"><a href="#cb74-376" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 350, y = 0.8,</span></span>
<span id="cb74-377"><a href="#cb74-377" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO, data = coefs_Boot_PIv_RBD_WBIO)),</span></span>
<span id="cb74-378"><a href="#cb74-378" aria-hidden="true" tabindex="-1"></a><span class="in">           color = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-379"><a href="#cb74-379" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE, # &lt;6&gt;</span></span>
<span id="cb74-380"><a href="#cb74-380" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-381"><a href="#cb74-381" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-382"><a href="#cb74-382" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-383"><a href="#cb74-383" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(PIv ~ RBD ~ "("*n ~ cm^"-1"*")")) +</span></span>
<span id="cb74-384"><a href="#cb74-384" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits, aes(x = WBIO, y = PIv_RBD,</span></span>
<span id="cb74-385"><a href="#cb74-385" aria-hidden="true" tabindex="-1"></a><span class="in">                                             label = species_label),</span></span>
<span id="cb74-386"><a href="#cb74-386" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black", size = 6) +</span></span>
<span id="cb74-387"><a href="#cb74-387" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-388"><a href="#cb74-388" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(color = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-389"><a href="#cb74-389" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(color = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-390"><a href="#cb74-390" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-391"><a href="#cb74-391" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-392"><a href="#cb74-392" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 21),</span></span>
<span id="cb74-393"><a href="#cb74-393" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-394"><a href="#cb74-394" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-395"><a href="#cb74-395" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-396"><a href="#cb74-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-397"><a href="#cb74-397" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`geom_smooth()`</span> will give a warning. However, we can ignore this since we want</span>
<span id="cb74-398"><a href="#cb74-398" aria-hidden="true" tabindex="-1"></a>the function to run over all species and not group by the</span>
<span id="cb74-399"><a href="#cb74-399" aria-hidden="true" tabindex="-1"></a>color aesthetic <span class="in">`"species"`</span>.</span>
<span id="cb74-400"><a href="#cb74-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-401"><a href="#cb74-401" aria-hidden="true" tabindex="-1"></a>Linear model to extract results</span>
<span id="cb74-402"><a href="#cb74-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-403"><a href="#cb74-403" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_PIvRBDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_PIv_RBD_WBIO)</span></span>
<span id="cb74-404"><a href="#cb74-404" aria-hidden="true" tabindex="-1"></a><span class="in">plot(stats_lm_boot_PIvRBDWBIO)</span></span>
<span id="cb74-405"><a href="#cb74-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-406"><a href="#cb74-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-407"><a href="#cb74-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-408"><a href="#cb74-408" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_PIvRBDWBIO)</span></span>
<span id="cb74-409"><a href="#cb74-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-410"><a href="#cb74-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-411"><a href="#cb74-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-412"><a href="#cb74-412" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_PIvRBDWBIO)</span></span>
<span id="cb74-413"><a href="#cb74-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-414"><a href="#cb74-414" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap CVt RBD over WBIO</span></span>
<span id="cb74-417"><a href="#cb74-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-418"><a href="#cb74-418" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb74-419"><a href="#cb74-419" aria-hidden="true" tabindex="-1"></a>Boot_CVt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-420"><a href="#cb74-420" aria-hidden="true" tabindex="-1"></a>  CVtRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-421"><a href="#cb74-421" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-422"><a href="#cb74-422" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-423"><a href="#cb74-423" aria-hidden="true" tabindex="-1"></a>  combin_split_CVtRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVtRBD_WBIO))</span>
<span id="cb74-424"><a href="#cb74-424" aria-hidden="true" tabindex="-1"></a>  RBD_WBIO <span class="ot">=</span> combin_split_CVtRBD_WBIO[,.(<span class="at">RBD =</span> (RBD_n_cm),</span>
<span id="cb74-425"><a href="#cb74-425" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">WBIO =</span> (WBIO)),</span>
<span id="cb74-426"><a href="#cb74-426" aria-hidden="true" tabindex="-1"></a>                                      by <span class="ot">=</span> .(species)]</span>
<span id="cb74-427"><a href="#cb74-427" aria-hidden="true" tabindex="-1"></a>  RBD_WBIO[, CVtRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RBD) <span class="sc">/</span> <span class="fu">mean</span>(RBD)),</span>
<span id="cb74-428"><a href="#cb74-428" aria-hidden="true" tabindex="-1"></a>           by <span class="ot">=</span> species]</span>
<span id="cb74-429"><a href="#cb74-429" aria-hidden="true" tabindex="-1"></a>  CVt_RBD_WBIO <span class="ot">=</span> RBD_WBIO[,.(<span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO),                <span class="co"># &lt;7&gt;</span></span>
<span id="cb74-430"><a href="#cb74-430" aria-hidden="true" tabindex="-1"></a>                             <span class="at">CVtRBD =</span> <span class="fu">mean</span>(CVtRBD)), by <span class="ot">=</span> species]</span>
<span id="cb74-431"><a href="#cb74-431" aria-hidden="true" tabindex="-1"></a>  CVt_RBD_WBIO <span class="ot">&lt;-</span> CVt_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVt_RBD_WBIO),</span>
<span id="cb74-432"><a href="#cb74-432" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVt_RBD_WBIO),</span>
<span id="cb74-433"><a href="#cb74-433" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-434"><a href="#cb74-434" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVtRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVtRBD <span class="sc">~</span> means_WBIO, <span class="at">data =</span> CVt_RBD_WBIO)</span>
<span id="cb74-435"><a href="#cb74-435" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">means_WBIO =</span> CVt_RBD_WBIO<span class="sc">$</span>means_WBIO,</span>
<span id="cb74-436"><a href="#cb74-436" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVt_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-437"><a href="#cb74-437" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVtRBDWBIO))</span>
<span id="cb74-438"><a href="#cb74-438" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-439"><a href="#cb74-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-440"><a href="#cb74-440" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Keep the mean for each species</span>
<span id="cb74-443"><a href="#cb74-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-444"><a href="#cb74-444" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVt_RBD_WBIO)</span>
<span id="cb74-445"><a href="#cb74-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-446"><a href="#cb74-446" aria-hidden="true" tabindex="-1"></a>Produce the figure</span>
<span id="cb74-447"><a href="#cb74-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-448"><a href="#cb74-448" aria-hidden="true" tabindex="-1"></a><span class="in">CVt_RBD_plot &lt;- ggplot(coefs_Boot_CVt_RBD_WBIO,</span></span>
<span id="cb74-449"><a href="#cb74-449" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(x = means_WBIO, y = y, color = species)) +</span></span>
<span id="cb74-450"><a href="#cb74-450" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-451"><a href="#cb74-451" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 350, y = 0.7,</span></span>
<span id="cb74-452"><a href="#cb74-452" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ means_WBIO, data = coefs_Boot_CVt_RBD_WBIO)),</span></span>
<span id="cb74-453"><a href="#cb74-453" aria-hidden="true" tabindex="-1"></a><span class="in">           color = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-454"><a href="#cb74-454" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-455"><a href="#cb74-455" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-456"><a href="#cb74-456" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-457"><a href="#cb74-457" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-458"><a href="#cb74-458" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(CVt ~ RBD ~ "("*n ~ cm^"-1"*")")) +</span></span>
<span id="cb74-459"><a href="#cb74-459" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-460"><a href="#cb74-460" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = CVt_RBD, label = species_label),</span></span>
<span id="cb74-461"><a href="#cb74-461" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black", size = 6) +</span></span>
<span id="cb74-462"><a href="#cb74-462" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-463"><a href="#cb74-463" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(color = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-464"><a href="#cb74-464" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(color = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-465"><a href="#cb74-465" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-466"><a href="#cb74-466" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-467"><a href="#cb74-467" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 21),</span></span>
<span id="cb74-468"><a href="#cb74-468" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-469"><a href="#cb74-469" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-470"><a href="#cb74-470" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-471"><a href="#cb74-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-472"><a href="#cb74-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-473"><a href="#cb74-473" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_CVtRBDWBIO &lt;- lm(y ~ means_WBIO, data = coefs_Boot_CVt_RBD_WBIO)</span></span>
<span id="cb74-474"><a href="#cb74-474" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_CVtRBDWBIO)</span></span>
<span id="cb74-475"><a href="#cb74-475" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_CVtRBDWBIO)</span></span>
<span id="cb74-476"><a href="#cb74-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-477"><a href="#cb74-477" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap PI : CV RBD over WBIO</span></span>
<span id="cb74-478"><a href="#cb74-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-479"><a href="#cb74-479" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(3)</span></span>
<span id="cb74-480"><a href="#cb74-480" aria-hidden="true" tabindex="-1"></a><span class="in">Boot_PIvCvt_RBD_WBIO &lt;- lapply(1:n, function(i){</span></span>
<span id="cb74-481"><a href="#cb74-481" aria-hidden="true" tabindex="-1"></a><span class="in">  PIvCVtRBD_WBIO &lt;- lapply(split_sp_h2o, function(j){</span></span>
<span id="cb74-482"><a href="#cb74-482" aria-hidden="true" tabindex="-1"></a><span class="in">    j[sample(1:nrow(j), nrow(j), replace = TRUE),]</span></span>
<span id="cb74-483"><a href="#cb74-483" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb74-484"><a href="#cb74-484" aria-hidden="true" tabindex="-1"></a><span class="in">  combin_split_PIvCVtRBD_WBIO &lt;- data.table::data.table(do.call("rbind", PIvCVtRBD_WBIO))</span></span>
<span id="cb74-485"><a href="#cb74-485" aria-hidden="true" tabindex="-1"></a><span class="in">  means_RBD_WBIO = combin_split_PIvCVtRBD_WBIO[,.(means_RBD = mean(RBD_n_cm),</span></span>
<span id="cb74-486"><a href="#cb74-486" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  means_WBIO = mean(WBIO)),</span></span>
<span id="cb74-487"><a href="#cb74-487" aria-hidden="true" tabindex="-1"></a><span class="in">                                               by = .(species, h2o)]</span></span>
<span id="cb74-488"><a href="#cb74-488" aria-hidden="true" tabindex="-1"></a><span class="in">  means_RBD_WBIO[, PIvRBD := (max(means_RBD) - min(means_RBD)) / max(means_RBD),</span></span>
<span id="cb74-489"><a href="#cb74-489" aria-hidden="true" tabindex="-1"></a><span class="in">                 by = species]</span></span>
<span id="cb74-490"><a href="#cb74-490" aria-hidden="true" tabindex="-1"></a><span class="in">  means_RBD_WBIO = means_RBD_WBIO[,.(mean_means_WBIO = mean(means_WBIO),</span></span>
<span id="cb74-491"><a href="#cb74-491" aria-hidden="true" tabindex="-1"></a><span class="in">                                     PIvRBD = mean(PIvRBD)), by = species]</span></span>
<span id="cb74-492"><a href="#cb74-492" aria-hidden="true" tabindex="-1"></a><span class="in">  combin_split_PIvCVtRBD_WBIO[, CVtRBD := (sd(RBD_n_cm) / mean(RBD_n_cm)),</span></span>
<span id="cb74-493"><a href="#cb74-493" aria-hidden="true" tabindex="-1"></a><span class="in">                              by = species]</span></span>
<span id="cb74-494"><a href="#cb74-494" aria-hidden="true" tabindex="-1"></a><span class="in">  mean_CVt = unique(combin_split_PIvCVtRBD_WBIO[, c("species", "CVtRBD")]) # &lt;8&gt;</span></span>
<span id="cb74-495"><a href="#cb74-495" aria-hidden="true" tabindex="-1"></a><span class="in">  matched_data = merge(means_RBD_WBIO, mean_CVt, by = "species") # &lt;9&gt;</span></span>
<span id="cb74-496"><a href="#cb74-496" aria-hidden="true" tabindex="-1"></a><span class="in">  matched_data[, PIv_CVt_ratio := PIvRBD / CVtRBD]</span></span>
<span id="cb74-497"><a href="#cb74-497" aria-hidden="true" tabindex="-1"></a><span class="in">  matched_data &lt;- matched_data[sample(1:nrow(matched_data),</span></span>
<span id="cb74-498"><a href="#cb74-498" aria-hidden="true" tabindex="-1"></a><span class="in">                                      nrow(matched_data),</span></span>
<span id="cb74-499"><a href="#cb74-499" aria-hidden="true" tabindex="-1"></a><span class="in">                                      replace = TRUE),] # &lt;10&gt;</span></span>
<span id="cb74-500"><a href="#cb74-500" aria-hidden="true" tabindex="-1"></a><span class="in">  lm_boot_PIvCVtRBDWBIO &lt;- lm(PIv_CVt_ratio ~ mean_means_WBIO, data = matched_data)</span></span>
<span id="cb74-501"><a href="#cb74-501" aria-hidden="true" tabindex="-1"></a><span class="in">  data.table::data.table(mean_means_WBIO = matched_data$mean_means_WBIO,</span></span>
<span id="cb74-502"><a href="#cb74-502" aria-hidden="true" tabindex="-1"></a><span class="in">                         species = matched_data$species,</span></span>
<span id="cb74-503"><a href="#cb74-503" aria-hidden="true" tabindex="-1"></a><span class="in">                         y = predict(lm_boot_PIvCVtRBDWBIO))</span></span>
<span id="cb74-504"><a href="#cb74-504" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb74-505"><a href="#cb74-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-506"><a href="#cb74-506" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Need 6 unique values for each species, above were duplicated 8 times</span>
<span id="cb74-507"><a href="#cb74-507" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Match values per species</span>
<span id="cb74-508"><a href="#cb74-508" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Optionally bootstrap species before doing the regression</span>
<span id="cb74-509"><a href="#cb74-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-510"><a href="#cb74-510" aria-hidden="true" tabindex="-1"></a>Store the results in a <span class="in">`data.table`</span></span>
<span id="cb74-513"><a href="#cb74-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-514"><a href="#cb74-514" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIvCvt_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIvCvt_RBD_WBIO)</span>
<span id="cb74-515"><a href="#cb74-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-516"><a href="#cb74-516" aria-hidden="true" tabindex="-1"></a>Produce the plot</span>
<span id="cb74-517"><a href="#cb74-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-518"><a href="#cb74-518" aria-hidden="true" tabindex="-1"></a><span class="in">PIvCVt_RBD_plot &lt;- ggplot(coefs_Boot_PIvCvt_RBD_WBIO,</span></span>
<span id="cb74-519"><a href="#cb74-519" aria-hidden="true" tabindex="-1"></a><span class="in">                          aes(mean_means_WBIO, y, color = species)) +</span></span>
<span id="cb74-520"><a href="#cb74-520" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-521"><a href="#cb74-521" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 350, y = 1.8,</span></span>
<span id="cb74-522"><a href="#cb74-522" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO,</span></span>
<span id="cb74-523"><a href="#cb74-523" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_PIvCvt_RBD_WBIO)),</span></span>
<span id="cb74-524"><a href="#cb74-524" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-525"><a href="#cb74-525" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-526"><a href="#cb74-526" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-527"><a href="#cb74-527" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-528"><a href="#cb74-528" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-529"><a href="#cb74-529" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(PI ~":"~ CV ~ RBD ~ "("*n ~ cm^"-1"*")")) +</span></span>
<span id="cb74-530"><a href="#cb74-530" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-531"><a href="#cb74-531" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = PI_CV_RBD, label = species_label),</span></span>
<span id="cb74-532"><a href="#cb74-532" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-533"><a href="#cb74-533" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-534"><a href="#cb74-534" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-535"><a href="#cb74-535" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-536"><a href="#cb74-536" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-537"><a href="#cb74-537" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-538"><a href="#cb74-538" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-539"><a href="#cb74-539" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 21),</span></span>
<span id="cb74-540"><a href="#cb74-540" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-541"><a href="#cb74-541" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-542"><a href="#cb74-542" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-543"><a href="#cb74-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-544"><a href="#cb74-544" aria-hidden="true" tabindex="-1"></a>Fit the linear regression to extract results</span>
<span id="cb74-545"><a href="#cb74-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-546"><a href="#cb74-546" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_PIvCVtRBDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_PIvCvt_RBD_WBIO)</span></span>
<span id="cb74-547"><a href="#cb74-547" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_PIvCVtRBDWBIO)</span></span>
<span id="cb74-548"><a href="#cb74-548" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_PIvCVtRBDWBIO)</span></span>
<span id="cb74-549"><a href="#cb74-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-550"><a href="#cb74-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap CVm RBD over WBIO</span></span>
<span id="cb74-553"><a href="#cb74-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-554"><a href="#cb74-554" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb74-555"><a href="#cb74-555" aria-hidden="true" tabindex="-1"></a>Boot_CVm_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-556"><a href="#cb74-556" aria-hidden="true" tabindex="-1"></a>  CVmRBD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-557"><a href="#cb74-557" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-558"><a href="#cb74-558" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-559"><a href="#cb74-559" aria-hidden="true" tabindex="-1"></a>  combin_split_CVmRBD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVmRBD_WBIO))</span>
<span id="cb74-560"><a href="#cb74-560" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO <span class="ot">=</span> combin_split_CVmRBD_WBIO[,.(<span class="at">means_RBD =</span> <span class="fu">mean</span>(RBD_n_cm),</span>
<span id="cb74-561"><a href="#cb74-561" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb74-562"><a href="#cb74-562" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb74-563"><a href="#cb74-563" aria-hidden="true" tabindex="-1"></a>  means_RBD_WBIO[, CVmRBD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(means_RBD) <span class="sc">/</span> <span class="fu">mean</span>(means_RBD)),</span>
<span id="cb74-564"><a href="#cb74-564" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb74-565"><a href="#cb74-565" aria-hidden="true" tabindex="-1"></a>  CVm_RBD_WBIO <span class="ot">=</span> means_RBD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb74-566"><a href="#cb74-566" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">CVmRBD =</span> <span class="fu">mean</span>(CVmRBD)), by <span class="ot">=</span> species]</span>
<span id="cb74-567"><a href="#cb74-567" aria-hidden="true" tabindex="-1"></a>  CVm_RBD_WBIO <span class="ot">&lt;-</span> CVm_RBD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVm_RBD_WBIO),</span>
<span id="cb74-568"><a href="#cb74-568" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVm_RBD_WBIO),</span>
<span id="cb74-569"><a href="#cb74-569" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-570"><a href="#cb74-570" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVmRBDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVmRBD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> CVm_RBD_WBIO)</span>
<span id="cb74-571"><a href="#cb74-571" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> CVm_RBD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb74-572"><a href="#cb74-572" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVm_RBD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-573"><a href="#cb74-573" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVmRBDWBIO))</span>
<span id="cb74-574"><a href="#cb74-574" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-575"><a href="#cb74-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-576"><a href="#cb74-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-579"><a href="#cb74-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-580"><a href="#cb74-580" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVm_RBD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVm_RBD_WBIO)</span>
<span id="cb74-581"><a href="#cb74-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-582"><a href="#cb74-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-583"><a href="#cb74-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-584"><a href="#cb74-584" aria-hidden="true" tabindex="-1"></a><span class="in">CVm_RBD_plot &lt;- ggplot(coefs_Boot_CVm_RBD_WBIO,</span></span>
<span id="cb74-585"><a href="#cb74-585" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(mean_means_WBIO, y, color = species)) +</span></span>
<span id="cb74-586"><a href="#cb74-586" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-587"><a href="#cb74-587" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 350, y = 0.8,</span></span>
<span id="cb74-588"><a href="#cb74-588" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO,</span></span>
<span id="cb74-589"><a href="#cb74-589" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_CVm_RBD_WBIO)),</span></span>
<span id="cb74-590"><a href="#cb74-590" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-591"><a href="#cb74-591" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-592"><a href="#cb74-592" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-593"><a href="#cb74-593" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-594"><a href="#cb74-594" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-595"><a href="#cb74-595" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(CVm ~ RBD ~ "("*n ~ cm^"-1"*")")) +</span></span>
<span id="cb74-596"><a href="#cb74-596" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-597"><a href="#cb74-597" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = CVm_RBD,</span></span>
<span id="cb74-598"><a href="#cb74-598" aria-hidden="true" tabindex="-1"></a><span class="in">                 label = species_label),</span></span>
<span id="cb74-599"><a href="#cb74-599" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-600"><a href="#cb74-600" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-601"><a href="#cb74-601" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-602"><a href="#cb74-602" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-603"><a href="#cb74-603" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-604"><a href="#cb74-604" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-605"><a href="#cb74-605" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-606"><a href="#cb74-606" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 21),</span></span>
<span id="cb74-607"><a href="#cb74-607" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-608"><a href="#cb74-608" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-609"><a href="#cb74-609" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-610"><a href="#cb74-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-611"><a href="#cb74-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-612"><a href="#cb74-612" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_CVmRBDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_CVm_RBD_WBIO)</span></span>
<span id="cb74-613"><a href="#cb74-613" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_CVmRBDWBIO)</span></span>
<span id="cb74-614"><a href="#cb74-614" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_CVmRBDWBIO)</span></span>
<span id="cb74-615"><a href="#cb74-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-616"><a href="#cb74-616" aria-hidden="true" tabindex="-1"></a><span class="fu">## Arrange multiplot RBD</span></span>
<span id="cb74-617"><a href="#cb74-617" aria-hidden="true" tabindex="-1"></a>To display the bootstrap results in a way that does not take up too much space, we need to produce a multiplot. Again, we can ignore the <span class="in">`geom_smooth()`</span> warning.</span>
<span id="cb74-618"><a href="#cb74-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE, message = FALSE}</span></span>
<span id="cb74-619"><a href="#cb74-619" aria-hidden="true" tabindex="-1"></a><span class="in">RBD_PIvCVtCVmPICV &lt;- cowplot::plot_grid(PIv_RBD_plot, CVt_RBD_plot,</span></span>
<span id="cb74-620"><a href="#cb74-620" aria-hidden="true" tabindex="-1"></a><span class="in">                                        PIvCVt_RBD_plot, CVm_RBD_plot,</span></span>
<span id="cb74-621"><a href="#cb74-621" aria-hidden="true" tabindex="-1"></a><span class="in">                                        labels = c("A", "B", "C", "D"),</span></span>
<span id="cb74-622"><a href="#cb74-622" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_size = 25,</span></span>
<span id="cb74-623"><a href="#cb74-623" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_fontfamily = "arial",</span></span>
<span id="cb74-624"><a href="#cb74-624" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_fontface = "bold",</span></span>
<span id="cb74-625"><a href="#cb74-625" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_colour = "black")</span></span>
<span id="cb74-626"><a href="#cb74-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-627"><a href="#cb74-627" aria-hidden="true" tabindex="-1"></a>Create common x-axis label</span>
<span id="cb74-630"><a href="#cb74-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-631"><a href="#cb74-631" aria-hidden="true" tabindex="-1"></a>x.grob_wbio <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="fu">expression</span>(Woody <span class="sc">~</span> biomass <span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">"-1"</span> <span class="sc">~</span> tree<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb74-632"><a href="#cb74-632" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fontsize =</span> <span class="dv">32</span>))</span>
<span id="cb74-633"><a href="#cb74-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-634"><a href="#cb74-634" aria-hidden="true" tabindex="-1"></a>Add common x-axis label and produce the multiplot. Of course, we would need to adjust the plot size accordingly to our window size.</span>
<span id="cb74-637"><a href="#cb74-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-638"><a href="#cb74-638" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(RBD_PIvCVtCVmPICV, <span class="at">bottom =</span> x.grob_wbio))</span>
<span id="cb74-639"><a href="#cb74-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-640"><a href="#cb74-640" aria-hidden="true" tabindex="-1"></a>Overall output table for our linear models. The variables (PIv, CVt, PI:CV, and CVm) are not named in the table below. However, based on their order in the above bootstrap's, we know that: 1) PIv, 2) CVt, 3) PI:CV, 4) CVm</span>
<span id="cb74-643"><a href="#cb74-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-644"><a href="#cb74-644" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(stats_lm_boot_PIvRBDWBIO, stats_lm_boot_CVtRBDWBIO,</span>
<span id="cb74-645"><a href="#cb74-645" aria-hidden="true" tabindex="-1"></a>                  stats_lm_boot_PIvCVtRBDWBIO, stats_lm_boot_CVmRBDWBIO,</span>
<span id="cb74-646"><a href="#cb74-646" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb74-647"><a href="#cb74-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-648"><a href="#cb74-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-649"><a href="#cb74-649" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap PIv RLD over WBIO</span></span>
<span id="cb74-650"><a href="#cb74-650" aria-hidden="true" tabindex="-1"></a>For Root length density (RLD; cm cm^-3^) we run exactly the same loop(s) as for RBD.</span>
<span id="cb74-653"><a href="#cb74-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-654"><a href="#cb74-654" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb74-655"><a href="#cb74-655" aria-hidden="true" tabindex="-1"></a>Boot_PIv_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-656"><a href="#cb74-656" aria-hidden="true" tabindex="-1"></a>  PIvRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-657"><a href="#cb74-657" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-658"><a href="#cb74-658" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-659"><a href="#cb74-659" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvRLD_WBIO))</span>
<span id="cb74-660"><a href="#cb74-660" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_PIvRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb74-661"><a href="#cb74-661" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb74-662"><a href="#cb74-662" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb74-663"><a href="#cb74-663" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, PIvRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RLD) <span class="sc">-</span> <span class="fu">min</span>(means_RLD)) <span class="sc">/</span> <span class="fu">max</span>(means_RLD),</span>
<span id="cb74-664"><a href="#cb74-664" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb74-665"><a href="#cb74-665" aria-hidden="true" tabindex="-1"></a>  PIv_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb74-666"><a href="#cb74-666" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">PIvRLD =</span> <span class="fu">mean</span>(PIvRLD)), by <span class="ot">=</span> species]</span>
<span id="cb74-667"><a href="#cb74-667" aria-hidden="true" tabindex="-1"></a>  PIv_RLD_WBIO <span class="ot">&lt;-</span> PIv_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(PIv_RLD_WBIO),</span>
<span id="cb74-668"><a href="#cb74-668" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(PIv_RLD_WBIO),</span>
<span id="cb74-669"><a href="#cb74-669" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-670"><a href="#cb74-670" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIvRLD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> PIv_RLD_WBIO)</span>
<span id="cb74-671"><a href="#cb74-671" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> PIv_RLD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb74-672"><a href="#cb74-672" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> PIv_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-673"><a href="#cb74-673" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvRLDWBIO))</span>
<span id="cb74-674"><a href="#cb74-674" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-675"><a href="#cb74-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-676"><a href="#cb74-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-679"><a href="#cb74-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-680"><a href="#cb74-680" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIv_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIv_RLD_WBIO)</span>
<span id="cb74-681"><a href="#cb74-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-682"><a href="#cb74-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-683"><a href="#cb74-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-684"><a href="#cb74-684" aria-hidden="true" tabindex="-1"></a><span class="in">PIv_RLD_plot &lt;- ggplot(coefs_Boot_PIv_RLD_WBIO,</span></span>
<span id="cb74-685"><a href="#cb74-685" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(mean_means_WBIO, y, color = species)) +</span></span>
<span id="cb74-686"><a href="#cb74-686" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-687"><a href="#cb74-687" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 300, y = 0.8,</span></span>
<span id="cb74-688"><a href="#cb74-688" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO,</span></span>
<span id="cb74-689"><a href="#cb74-689" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_PIv_RLD_WBIO)),</span></span>
<span id="cb74-690"><a href="#cb74-690" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-691"><a href="#cb74-691" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-692"><a href="#cb74-692" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-693"><a href="#cb74-693" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-694"><a href="#cb74-694" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-695"><a href="#cb74-695" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(PIv ~ RLD ~ "("*cm ~ cm^"-3"*")")) +</span></span>
<span id="cb74-696"><a href="#cb74-696" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-697"><a href="#cb74-697" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = PIv_RLD,</span></span>
<span id="cb74-698"><a href="#cb74-698" aria-hidden="true" tabindex="-1"></a><span class="in">                 label = species_label),</span></span>
<span id="cb74-699"><a href="#cb74-699" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-700"><a href="#cb74-700" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-701"><a href="#cb74-701" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-702"><a href="#cb74-702" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-703"><a href="#cb74-703" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-704"><a href="#cb74-704" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-705"><a href="#cb74-705" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-706"><a href="#cb74-706" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 20),</span></span>
<span id="cb74-707"><a href="#cb74-707" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-708"><a href="#cb74-708" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-709"><a href="#cb74-709" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-710"><a href="#cb74-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-711"><a href="#cb74-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-712"><a href="#cb74-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-713"><a href="#cb74-713" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_PIvRLDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_PIv_RLD_WBIO)</span></span>
<span id="cb74-714"><a href="#cb74-714" aria-hidden="true" tabindex="-1"></a><span class="in">plot(stats_lm_boot_PIvRLDWBIO)</span></span>
<span id="cb74-715"><a href="#cb74-715" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_PIvRLDWBIO)</span></span>
<span id="cb74-716"><a href="#cb74-716" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_PIvRLDWBIO)</span></span>
<span id="cb74-717"><a href="#cb74-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-718"><a href="#cb74-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-719"><a href="#cb74-719" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap CVt RLD over WBIO</span></span>
<span id="cb74-722"><a href="#cb74-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-723"><a href="#cb74-723" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb74-724"><a href="#cb74-724" aria-hidden="true" tabindex="-1"></a>Boot_CVt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-725"><a href="#cb74-725" aria-hidden="true" tabindex="-1"></a>  CVtRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-726"><a href="#cb74-726" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-727"><a href="#cb74-727" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-728"><a href="#cb74-728" aria-hidden="true" tabindex="-1"></a>  combin_split_CVtRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVtRLD_WBIO))</span>
<span id="cb74-729"><a href="#cb74-729" aria-hidden="true" tabindex="-1"></a>  RLD_WBIO <span class="ot">=</span> combin_split_CVtRLD_WBIO[,.(<span class="at">RLD =</span> (RLD_CM_cm3),</span>
<span id="cb74-730"><a href="#cb74-730" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">WBIO =</span> (WBIO)),</span>
<span id="cb74-731"><a href="#cb74-731" aria-hidden="true" tabindex="-1"></a>                                      by <span class="ot">=</span> .(species)]</span>
<span id="cb74-732"><a href="#cb74-732" aria-hidden="true" tabindex="-1"></a>  RLD_WBIO[, CVtRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RLD) <span class="sc">/</span> <span class="fu">mean</span>(RLD)),</span>
<span id="cb74-733"><a href="#cb74-733" aria-hidden="true" tabindex="-1"></a>           by <span class="ot">=</span> species]</span>
<span id="cb74-734"><a href="#cb74-734" aria-hidden="true" tabindex="-1"></a>  CVt_RLD_WBIO <span class="ot">=</span> RLD_WBIO[,.(<span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO),</span>
<span id="cb74-735"><a href="#cb74-735" aria-hidden="true" tabindex="-1"></a>                             <span class="at">CVtRLD =</span> <span class="fu">mean</span>(CVtRLD)), by <span class="ot">=</span> species]</span>
<span id="cb74-736"><a href="#cb74-736" aria-hidden="true" tabindex="-1"></a>  CVt_RLD_WBIO <span class="ot">&lt;-</span> CVt_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVt_RLD_WBIO),</span>
<span id="cb74-737"><a href="#cb74-737" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVt_RLD_WBIO),</span>
<span id="cb74-738"><a href="#cb74-738" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-739"><a href="#cb74-739" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVtRLD <span class="sc">~</span> means_WBIO, <span class="at">data =</span> CVt_RLD_WBIO)</span>
<span id="cb74-740"><a href="#cb74-740" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">means_WBIO =</span> CVt_RLD_WBIO<span class="sc">$</span>means_WBIO,</span>
<span id="cb74-741"><a href="#cb74-741" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVt_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-742"><a href="#cb74-742" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVtRLDWBIO))</span>
<span id="cb74-743"><a href="#cb74-743" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-744"><a href="#cb74-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-745"><a href="#cb74-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-748"><a href="#cb74-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-749"><a href="#cb74-749" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVt_RLD_WBIO)</span>
<span id="cb74-750"><a href="#cb74-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-751"><a href="#cb74-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-752"><a href="#cb74-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-753"><a href="#cb74-753" aria-hidden="true" tabindex="-1"></a><span class="in">CVt_RLD_plot &lt;- ggplot(coefs_Boot_CVt_RLD_WBIO,</span></span>
<span id="cb74-754"><a href="#cb74-754" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(means_WBIO, y, color = species)) +</span></span>
<span id="cb74-755"><a href="#cb74-755" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-756"><a href="#cb74-756" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 280, y = 0.75,</span></span>
<span id="cb74-757"><a href="#cb74-757" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ means_WBIO,</span></span>
<span id="cb74-758"><a href="#cb74-758" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_CVt_RLD_WBIO)),</span></span>
<span id="cb74-759"><a href="#cb74-759" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-760"><a href="#cb74-760" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-761"><a href="#cb74-761" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-762"><a href="#cb74-762" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-763"><a href="#cb74-763" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-764"><a href="#cb74-764" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(CVt ~ RLD ~ "("*cm ~ cm^"-3"*")")) +</span></span>
<span id="cb74-765"><a href="#cb74-765" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-766"><a href="#cb74-766" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = CVt_RLD,</span></span>
<span id="cb74-767"><a href="#cb74-767" aria-hidden="true" tabindex="-1"></a><span class="in">                 label = species_label),</span></span>
<span id="cb74-768"><a href="#cb74-768" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-769"><a href="#cb74-769" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-770"><a href="#cb74-770" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-771"><a href="#cb74-771" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-772"><a href="#cb74-772" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-773"><a href="#cb74-773" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-774"><a href="#cb74-774" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-775"><a href="#cb74-775" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 20),</span></span>
<span id="cb74-776"><a href="#cb74-776" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-777"><a href="#cb74-777" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-778"><a href="#cb74-778" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-779"><a href="#cb74-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-780"><a href="#cb74-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-781"><a href="#cb74-781" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_CVtRLDWBIO &lt;- lm(y ~ means_WBIO, data = coefs_Boot_CVt_RLD_WBIO)</span></span>
<span id="cb74-782"><a href="#cb74-782" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_CVtRLDWBIO)</span></span>
<span id="cb74-783"><a href="#cb74-783" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_CVtRLDWBIO)</span></span>
<span id="cb74-784"><a href="#cb74-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-785"><a href="#cb74-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-786"><a href="#cb74-786" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap PI : CV RLD over WBIO</span></span>
<span id="cb74-789"><a href="#cb74-789" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-790"><a href="#cb74-790" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb74-791"><a href="#cb74-791" aria-hidden="true" tabindex="-1"></a>Boot_PIvCvt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-792"><a href="#cb74-792" aria-hidden="true" tabindex="-1"></a>  PIvCVtRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-793"><a href="#cb74-793" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-794"><a href="#cb74-794" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-795"><a href="#cb74-795" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, PIvCVtRLD_WBIO))</span>
<span id="cb74-796"><a href="#cb74-796" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_PIvCVtRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb74-797"><a href="#cb74-797" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb74-798"><a href="#cb74-798" aria-hidden="true" tabindex="-1"></a>                                               by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb74-799"><a href="#cb74-799" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, PIvRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">max</span>(means_RLD) <span class="sc">-</span> <span class="fu">min</span>(means_RLD)) <span class="sc">/</span> <span class="fu">max</span>(means_RLD),</span>
<span id="cb74-800"><a href="#cb74-800" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb74-801"><a href="#cb74-801" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb74-802"><a href="#cb74-802" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PIvRLD =</span> <span class="fu">mean</span>(PIvRLD)), by <span class="ot">=</span> species]</span>
<span id="cb74-803"><a href="#cb74-803" aria-hidden="true" tabindex="-1"></a>  combin_split_PIvCVtRLD_WBIO[, CVtRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(RLD_CM_cm3) <span class="sc">/</span> <span class="fu">mean</span>(RLD_CM_cm3)),</span>
<span id="cb74-804"><a href="#cb74-804" aria-hidden="true" tabindex="-1"></a>                              by <span class="ot">=</span> species]</span>
<span id="cb74-805"><a href="#cb74-805" aria-hidden="true" tabindex="-1"></a>  mean_CVt <span class="ot">=</span> <span class="fu">unique</span>(combin_split_PIvCVtRLD_WBIO[, <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"CVtRLD"</span>)])</span>
<span id="cb74-806"><a href="#cb74-806" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">=</span> <span class="fu">merge</span>(means_RLD_WBIO, mean_CVt, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb74-807"><a href="#cb74-807" aria-hidden="true" tabindex="-1"></a>  matched_data[, PIv_CVt_ratio <span class="sc">:</span><span class="er">=</span> PIvRLD <span class="sc">/</span> CVtRLD]</span>
<span id="cb74-808"><a href="#cb74-808" aria-hidden="true" tabindex="-1"></a>  matched_data <span class="ot">&lt;-</span> matched_data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matched_data),</span>
<span id="cb74-809"><a href="#cb74-809" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(matched_data),</span>
<span id="cb74-810"><a href="#cb74-810" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-811"><a href="#cb74-811" aria-hidden="true" tabindex="-1"></a>  lm_boot_PIvCVtRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIv_CVt_ratio <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> matched_data)</span>
<span id="cb74-812"><a href="#cb74-812" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> matched_data<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb74-813"><a href="#cb74-813" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> matched_data<span class="sc">$</span>species,</span>
<span id="cb74-814"><a href="#cb74-814" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_PIvCVtRLDWBIO))</span>
<span id="cb74-815"><a href="#cb74-815" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-816"><a href="#cb74-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-817"><a href="#cb74-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-820"><a href="#cb74-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-821"><a href="#cb74-821" aria-hidden="true" tabindex="-1"></a>coefs_Boot_PIvCvt_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_PIvCvt_RLD_WBIO)</span>
<span id="cb74-822"><a href="#cb74-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-823"><a href="#cb74-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-824"><a href="#cb74-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-825"><a href="#cb74-825" aria-hidden="true" tabindex="-1"></a><span class="in">PIvCVt_RLD_plot &lt;- ggplot(coefs_Boot_PIvCvt_RLD_WBIO,</span></span>
<span id="cb74-826"><a href="#cb74-826" aria-hidden="true" tabindex="-1"></a><span class="in">                          aes(mean_means_WBIO, y, color = species)) +</span></span>
<span id="cb74-827"><a href="#cb74-827" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-828"><a href="#cb74-828" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 350, y = 1.7,</span></span>
<span id="cb74-829"><a href="#cb74-829" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO,</span></span>
<span id="cb74-830"><a href="#cb74-830" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_PIvCvt_RLD_WBIO)),</span></span>
<span id="cb74-831"><a href="#cb74-831" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-832"><a href="#cb74-832" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-833"><a href="#cb74-833" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-834"><a href="#cb74-834" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-835"><a href="#cb74-835" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-836"><a href="#cb74-836" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(PI ~":"~ CV ~ RLD ~ "("*cm ~ cm^"-3"*")")) +</span></span>
<span id="cb74-837"><a href="#cb74-837" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-838"><a href="#cb74-838" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = PI_CV_RLD,</span></span>
<span id="cb74-839"><a href="#cb74-839" aria-hidden="true" tabindex="-1"></a><span class="in">                 label = species_label),</span></span>
<span id="cb74-840"><a href="#cb74-840" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-841"><a href="#cb74-841" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-842"><a href="#cb74-842" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-843"><a href="#cb74-843" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-844"><a href="#cb74-844" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-845"><a href="#cb74-845" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-846"><a href="#cb74-846" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-847"><a href="#cb74-847" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 20),</span></span>
<span id="cb74-848"><a href="#cb74-848" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-849"><a href="#cb74-849" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-850"><a href="#cb74-850" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-851"><a href="#cb74-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-852"><a href="#cb74-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-853"><a href="#cb74-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-854"><a href="#cb74-854" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_PIvCVtRLDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_PIvCvt_RLD_WBIO)</span></span>
<span id="cb74-855"><a href="#cb74-855" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_PIvCVtRLDWBIO)</span></span>
<span id="cb74-856"><a href="#cb74-856" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_PIvCVtRLDWBIO)</span></span>
<span id="cb74-857"><a href="#cb74-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-858"><a href="#cb74-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-859"><a href="#cb74-859" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bootstrap CVm RLD over WBIO</span></span>
<span id="cb74-862"><a href="#cb74-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-863"><a href="#cb74-863" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb74-864"><a href="#cb74-864" aria-hidden="true" tabindex="-1"></a>Boot_CVm_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb74-865"><a href="#cb74-865" aria-hidden="true" tabindex="-1"></a>  CVmRLD_WBIO <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_sp_h2o, <span class="cf">function</span>(j){</span>
<span id="cb74-866"><a href="#cb74-866" aria-hidden="true" tabindex="-1"></a>    j[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(j), <span class="fu">nrow</span>(j), <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-867"><a href="#cb74-867" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-868"><a href="#cb74-868" aria-hidden="true" tabindex="-1"></a>  combin_split_CVmRLD_WBIO <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, CVmRLD_WBIO))</span>
<span id="cb74-869"><a href="#cb74-869" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO <span class="ot">=</span> combin_split_CVmRLD_WBIO[,.(<span class="at">means_RLD =</span> <span class="fu">mean</span>(RLD_CM_cm3),</span>
<span id="cb74-870"><a href="#cb74-870" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">means_WBIO =</span> <span class="fu">mean</span>(WBIO)),</span>
<span id="cb74-871"><a href="#cb74-871" aria-hidden="true" tabindex="-1"></a>                                            by <span class="ot">=</span> .(species, h2o)]</span>
<span id="cb74-872"><a href="#cb74-872" aria-hidden="true" tabindex="-1"></a>  means_RLD_WBIO[, CVmRLD <span class="sc">:</span><span class="er">=</span> (<span class="fu">sd</span>(means_RLD) <span class="sc">/</span> <span class="fu">mean</span>(means_RLD)),</span>
<span id="cb74-873"><a href="#cb74-873" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> species]</span>
<span id="cb74-874"><a href="#cb74-874" aria-hidden="true" tabindex="-1"></a>  CVm_RLD_WBIO <span class="ot">=</span> means_RLD_WBIO[,.(<span class="at">mean_means_WBIO =</span> <span class="fu">mean</span>(means_WBIO),</span>
<span id="cb74-875"><a href="#cb74-875" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">CVmRLD =</span> <span class="fu">mean</span>(CVmRLD)), by <span class="ot">=</span> species]</span>
<span id="cb74-876"><a href="#cb74-876" aria-hidden="true" tabindex="-1"></a>  CVm_RLD_WBIO <span class="ot">&lt;-</span> CVm_RLD_WBIO[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CVm_RLD_WBIO),</span>
<span id="cb74-877"><a href="#cb74-877" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">nrow</span>(CVm_RLD_WBIO),</span>
<span id="cb74-878"><a href="#cb74-878" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb74-879"><a href="#cb74-879" aria-hidden="true" tabindex="-1"></a>  lm_boot_CVmRLDWBIO <span class="ot">&lt;-</span> <span class="fu">lm</span>(CVmRLD <span class="sc">~</span> mean_means_WBIO, <span class="at">data =</span> CVm_RLD_WBIO)</span>
<span id="cb74-880"><a href="#cb74-880" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">mean_means_WBIO =</span> CVm_RLD_WBIO<span class="sc">$</span>mean_means_WBIO,</span>
<span id="cb74-881"><a href="#cb74-881" aria-hidden="true" tabindex="-1"></a>                         <span class="at">species =</span> CVm_RLD_WBIO<span class="sc">$</span>species,</span>
<span id="cb74-882"><a href="#cb74-882" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">predict</span>(lm_boot_CVmRLDWBIO))</span>
<span id="cb74-883"><a href="#cb74-883" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-884"><a href="#cb74-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-885"><a href="#cb74-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-888"><a href="#cb74-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-889"><a href="#cb74-889" aria-hidden="true" tabindex="-1"></a>coefs_Boot_CVm_RLD_WBIO <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, Boot_CVm_RLD_WBIO)</span>
<span id="cb74-890"><a href="#cb74-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-891"><a href="#cb74-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-892"><a href="#cb74-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE}</span></span>
<span id="cb74-893"><a href="#cb74-893" aria-hidden="true" tabindex="-1"></a><span class="in">CVm_RLD_plot &lt;- ggplot(coefs_Boot_CVm_RLD_WBIO,</span></span>
<span id="cb74-894"><a href="#cb74-894" aria-hidden="true" tabindex="-1"></a><span class="in">                       aes(mean_means_WBIO, y, color = species)) +</span></span>
<span id="cb74-895"><a href="#cb74-895" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 1/10) +</span></span>
<span id="cb74-896"><a href="#cb74-896" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 300, y = 0.9,</span></span>
<span id="cb74-897"><a href="#cb74-897" aria-hidden="true" tabindex="-1"></a><span class="in">           label = lm_eqn(lm(y ~ mean_means_WBIO,</span></span>
<span id="cb74-898"><a href="#cb74-898" aria-hidden="true" tabindex="-1"></a><span class="in">                             data = coefs_Boot_CVm_RLD_WBIO)),</span></span>
<span id="cb74-899"><a href="#cb74-899" aria-hidden="true" tabindex="-1"></a><span class="in">           colour = "black", size = 7, parse = TRUE) +</span></span>
<span id="cb74-900"><a href="#cb74-900" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", linewidth = 1, se = TRUE,</span></span>
<span id="cb74-901"><a href="#cb74-901" aria-hidden="true" tabindex="-1"></a><span class="in">              aes(group = 1),</span></span>
<span id="cb74-902"><a href="#cb74-902" aria-hidden="true" tabindex="-1"></a><span class="in">              show.legend = FALSE) +</span></span>
<span id="cb74-903"><a href="#cb74-903" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = expression(Woody ~ biomass ~ "("*g^"-1" ~ tree*")"),</span></span>
<span id="cb74-904"><a href="#cb74-904" aria-hidden="true" tabindex="-1"></a><span class="in">       y = expression(CVm ~ RLD ~ "("*cm ~ cm^"-3"*")")) +</span></span>
<span id="cb74-905"><a href="#cb74-905" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(data = Plast_abs_sp_traits,</span></span>
<span id="cb74-906"><a href="#cb74-906" aria-hidden="true" tabindex="-1"></a><span class="in">             aes(x = WBIO, y = CVm_RLD,</span></span>
<span id="cb74-907"><a href="#cb74-907" aria-hidden="true" tabindex="-1"></a><span class="in">                 label = species_label),</span></span>
<span id="cb74-908"><a href="#cb74-908" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "black",</span></span>
<span id="cb74-909"><a href="#cb74-909" aria-hidden="true" tabindex="-1"></a><span class="in">             size = 6) +</span></span>
<span id="cb74-910"><a href="#cb74-910" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb74-911"><a href="#cb74-911" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.ticks = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-912"><a href="#cb74-912" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.major = element_line(colour = "grey70", linewidth = 0.2),</span></span>
<span id="cb74-913"><a href="#cb74-913" aria-hidden="true" tabindex="-1"></a><span class="in">        panel.grid.minor = element_blank(),</span></span>
<span id="cb74-914"><a href="#cb74-914" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.x = element_blank(),</span></span>
<span id="cb74-915"><a href="#cb74-915" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_text(size = 20),</span></span>
<span id="cb74-916"><a href="#cb74-916" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.x = element_text(size = 25),</span></span>
<span id="cb74-917"><a href="#cb74-917" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-918"><a href="#cb74-918" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none")</span></span>
<span id="cb74-919"><a href="#cb74-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-920"><a href="#cb74-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, output = FALSE}</span></span>
<span id="cb74-921"><a href="#cb74-921" aria-hidden="true" tabindex="-1"></a><span class="in">stats_lm_boot_CVmRLDWBIO &lt;- lm(y ~ mean_means_WBIO, data = coefs_Boot_CVm_RLD_WBIO)</span></span>
<span id="cb74-922"><a href="#cb74-922" aria-hidden="true" tabindex="-1"></a><span class="in">summary(stats_lm_boot_CVmRLDWBIO)</span></span>
<span id="cb74-923"><a href="#cb74-923" aria-hidden="true" tabindex="-1"></a><span class="in">anova(stats_lm_boot_CVmRLDWBIO)</span></span>
<span id="cb74-924"><a href="#cb74-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-925"><a href="#cb74-925" aria-hidden="true" tabindex="-1"></a><span class="fu">## Arrange multiplot RLD</span></span>
<span id="cb74-926"><a href="#cb74-926" aria-hidden="true" tabindex="-1"></a>To display the bootstrap results in a way that does not take up too much space, we need to produce a multiplot. Again, we can ignore the <span class="in">`geom_smooth()`</span> warning.</span>
<span id="cb74-927"><a href="#cb74-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, output = FALSE, message = FALSE}</span></span>
<span id="cb74-928"><a href="#cb74-928" aria-hidden="true" tabindex="-1"></a><span class="in">RLD_PIvCVtCVmPICV &lt;- cowplot::plot_grid(PIv_RLD_plot, CVt_RLD_plot,</span></span>
<span id="cb74-929"><a href="#cb74-929" aria-hidden="true" tabindex="-1"></a><span class="in">                                        PIvCVt_RLD_plot, CVm_RLD_plot,</span></span>
<span id="cb74-930"><a href="#cb74-930" aria-hidden="true" tabindex="-1"></a><span class="in">                                        labels = c("A", "B", "C", "D"),</span></span>
<span id="cb74-931"><a href="#cb74-931" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_size = 25,</span></span>
<span id="cb74-932"><a href="#cb74-932" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_fontfamily = "arial",</span></span>
<span id="cb74-933"><a href="#cb74-933" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_fontface = "bold",</span></span>
<span id="cb74-934"><a href="#cb74-934" aria-hidden="true" tabindex="-1"></a><span class="in">                                        label_colour = "black")</span></span>
<span id="cb74-935"><a href="#cb74-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-936"><a href="#cb74-936" aria-hidden="true" tabindex="-1"></a>Create common x-axis label --&gt; <span class="in">`"x.grob_wbio"`</span> specified above!</span>
<span id="cb74-939"><a href="#cb74-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-940"><a href="#cb74-940" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(RLD_PIvCVtCVmPICV, <span class="at">bottom =</span> x.grob_wbio))</span>
<span id="cb74-941"><a href="#cb74-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-942"><a href="#cb74-942" aria-hidden="true" tabindex="-1"></a>Overall output table for our linear models. The variables (PIv, CVt, PI:CV, and CVm) are not named in the table below. However, based on their order in the above bootstrap's, we know that: 1) PIv, 2) CVt, 3) PI:CV, 4) CVm</span>
<span id="cb74-945"><a href="#cb74-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-946"><a href="#cb74-946" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(stats_lm_boot_PIvRLDWBIO, stats_lm_boot_CVtRLDWBIO,</span>
<span id="cb74-947"><a href="#cb74-947" aria-hidden="true" tabindex="-1"></a>                  stats_lm_boot_PIvCVtRLDWBIO, stats_lm_boot_CVmRLDWBIO,</span>
<span id="cb74-948"><a href="#cb74-948" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb74-949"><a href="#cb74-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-950"><a href="#cb74-950" aria-hidden="true" tabindex="-1"></a>**We explored all the other absorptive fine root trait relationships with above ground woody biomass. None of these relationships showed strong $R^2$ values.**</span>
<span id="cb74-951"><a href="#cb74-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-952"><a href="#cb74-952" aria-hidden="true" tabindex="-1"></a><span class="fu"># Invitation for collaboration</span></span>
<span id="cb74-953"><a href="#cb74-953" aria-hidden="true" tabindex="-1"></a>We welcome feedback, collaboration, and further research based on this study. If you have any questions, suggestions, or would like to collaborate on extending this work, please contact us.</span>
<span id="cb74-954"><a href="#cb74-954" aria-hidden="true" tabindex="-1"></a>For a detailed discussion and conclusion, please refer to the main research paper.</span>
<span id="cb74-955"><a href="#cb74-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-956"><a href="#cb74-956" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reproduction guidelines and further research</span></span>
<span id="cb74-957"><a href="#cb74-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-958"><a href="#cb74-958" aria-hidden="true" tabindex="-1"></a>To reproduce the analyses presented in this study:</span>
<span id="cb74-959"><a href="#cb74-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-960"><a href="#cb74-960" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Download the data from <span class="co">[</span><span class="ot">GitHUb</span><span class="co">](https://github.com/Florentin85/Data_code_rootTraits_IDENT-SSM)</span>.</span>
<span id="cb74-961"><a href="#cb74-961" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Clone the <span class="co">[</span><span class="ot">code repository</span><span class="co">](https://github.com/Florentin85/Data_code_rootTraits_IDENT-SSM)</span>.</span>
<span id="cb74-962"><a href="#cb74-962" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Follow the instructions in the README file to set up the environment and run the analyses.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>